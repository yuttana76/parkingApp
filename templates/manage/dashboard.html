<!DOCTYPE html>
<html lang="en">

<head>
    {% include "include/manage-css.html" %}
    {% include "include/manage-js.html" %}
    <title>MRTA Dashboard</title>
    <meta charset="UTF-8">

    <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/manage/modalbox.css') }}"> -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/manage/adminlte.css') }}">

    <link href="//cdn.datatables.net/1.10.20/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="//cdn.datatables.net/buttons/1.6.2/css/buttons.dataTables.min.css" rel="stylesheet" />
 
    <!-- <script src="//code.jquery.com/jquery-3.5.1.js"></script> -->
    <script src="//cdn.datatables.net/1.10.21/js/jquery.dataTables.min.js"></script>

    <script src="//cdn.datatables.net/buttons/1.6.2/js/dataTables.buttons.min.js"></script>
    <script src="//cdn.datatables.net/buttons/1.6.2/js/buttons.flash.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
    <script src="//cdn.datatables.net/buttons/1.6.2/js/buttons.html5.min.js"></script>
    <script src="//cdn.datatables.net/buttons/1.6.2/js/buttons.print.min.js"></script>
</head>
<style>
    /********************Show word color ID_card***********************/
    .container {
        padding: 15px;
    }

    .error {
        color: #F00;
    }

    .error.true {
        color: #6bc900;
    }
 
    .mySlides {display:none;}

    /********************Show word color ID_card End***********************/
</style>

<body class="hold-transition sidebar-mini layout-fixed" scroll="no" style="overflow-x: hidden;">
    <div class="wrapper">
        {% include "manage/comps/header.html" %}
        {% include "manage/comps/sidebar.html" %}

        <!-- Messenger ปลั๊กอินแชท Code -->
        <div id="fb-root"></div>

        <!-- Your ปลั๊กอินแชท code -->
        <div id="fb-customer-chat" class="fb-customerchat">
        </div>


        <div class="content-wrapper">
            <div class="content-header">
                <div class="container-fluid">
                    <div class="row mb-3">
                        <div class="col-sm-6">
                            <h1 class="m-0" style="color: #1a086e; font-size: 38px; font-weight: bold;">Dashboard</h1>
                        </div>
                        <div class="col-lg-12">
                            <div class="row">
                                <div class="col-lg-4">
                                    <select id="line">
                                        <option>--กรุณาเลือกสาย--</option>
                                    </select>
                                </div>

                                <div class="col-lg-4">
                                    <select id="park">
                                        <option>--กรุณาเลือกลานจอด--</option>
                                    </select>
                                </div>

                                <div class="col-lg-4">
                                    <div class="input-group-btn" style="margin-right: 10px;">
                                        <button class="btn btn-default" type="submit" style="background-color: #1a086e; 
                                            height: 47px; margin: 1px;" onclick="tableNew_cus()">
                                            <i class="fa fa-search" aria-hidden="true"
                                                style="color: #ffffff; height: 30px; padding: 5px;"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>

                            <select style=" width: 15%;" id="filter_verify">
                                <option>--สถานะตรวจสอบ--</option>
                                <option>ผ่านการตรวจสอบ</option>
                                <option>ไม่ผ่านการตรวจสอบ</option>

                            </select>

                            <select  style=" width: 15%;" id="filter_paystatus">
                                <option>--สถานะชำระเงิน--</option>
                                <option>ชำระแล้ว</option>
                                <option>ยังไม่ได้ชำระ</option>

                            </select>

                            <select  style=" width: 15%;" id="filter_payment">
                                <option>--ช่องทางชำระ--</option>
                                <option>เงินสด</option>
                                <option>บัตรเครดิต</option>
                                <option>QR Code</option>
                                <option>ผูกบัญชี</option>

                            </select>

                            <!-- <select style=" width: 15%;">
                                <option>--สถานะคืนบัตร--</option>
                                <option>คืนบัตร</option>
                                <option>ไม่คืนบัตร</option>

                            </select> -->

                        </div>
                    </div>
                </div>



                <div class="row">
                    <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                        <div class="info-box">
                            <div class="info-box-content">
                                <span class="info-box-text">รอตรวจสอบ (สมัครใหม่)</span>
                                <span class="info-box-number" id='count_new'>{{count_new}}</span>
                            </div>
                            <span class="info-box-icon bg-info elevation-1"><i class="fas fa-calendar-alt"></i></span>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                        <div class="info-box mb-3">
                            <div class="info-box-content">
                                <span class="info-box-text">จำนวนต่ออายุ</span>
                                <span class="info-box-number" id='count_old'>{{count_old}}</span>
                            </div>
                            <span class="info-box-icon bg-danger elevation-1"><i class="fas fa-calendar-alt"></i></span>
                        </div>
                    </div>

                    <div class="clearfix hidden-md-up"></div>

                    <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                        <div class="info-box mb-3">
                            <div class="info-box-content">
                                <span class="info-box-text">รายได้ประจำเดือน</span>
                                <span class="info-box-number" id='total_month'>{{total_month}}</span>
                            </div>
                            <span class="info-box-icon bg-success elevation-1"><i class="fab fa-bitcoin"></i></span>
                        </div>
                    </div>
                    <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                        <div class="info-box mb-3">
                            <div class="info-box-content">
                                <span class="info-box-text">รายได้ประจำวัน</span>
                                <span class="info-box-number" id='total_today'>{{total_today}}</span>
                            </div>
                            <span class="info-box-icon bg-warning elevation-1"><i class="fab fa-bitcoin"></i></span>
                        </div>
                    </div>              
                    <div class="col-12 col-sm-6 col-md-4 col-lg-4">
                        <div class="info-box mb-3">
                            <div class="info-box-content">
                                <span class="info-box-text">จำนวนคิวล่าสุด</span>
                                <span class="info-box-number" id='count_q'>{{count_q}}</span>
                            </div>
                            <span class="info-box-icon bg-secondary elevation-1"><i class="fab fa-bitcoin"></i></span>
                        </div>
                    </div>       
                </div>
            </div>
   

            <div class="row">
                <div class="col-sm-4 input-group">
                    <input type="text" id="search" class="form-control ml-2" placeholder=" ค้นหารหัสบัตร" name="search" />
                    <div class="input-group-btn">
                        <button class="btn btn-primary" type="submit">
                            <i class="fas fa-search"></i></button>
                    </div>
                    <button class="btn btn-success mb-2 ml-3"  class="far fa-file-excel" onclick="exportTableToExcel()">Export To Excel File</button>
                </div>
                <div class="col-sm-4"></div>
                <div class="col-sm-4">
                    <div class="filter" style="margin-bottom: 2%;">

                        <button class="btn btn-primary mb-2 mr-2" data-toggle="modal" data-target="#exampleModal-add"
                            style="margin-left: auto; float: right;">
                            <i class="fas fa-plus"></i> เพิ่มรายการใหม่
                        </button>
                        <!--button add -->
                    </div>
                </div>
            </div>

            <!-- nav-bar -->
            <div class="col-sm-12" style="margin-top: 2%;">
                <div class="card card-primary card-tabs" style="width: 100%;">
                    <div class="card-header p-0 pt-1">
                        <ul class="nav nav-tabs" id="custom-tabs-one-tab" role="tablist">
                            <li class="nav-item">
                                <a class="nav-link active" id="custom-tabs-one-home-tab" data-toggle="pill"
                                    href="#custom-tabs-one-home" role="tab" aria-controls="custom-tabs-one-home"
                                    aria-selected="true" onclick="tableNew_cus()">รายการสมัครใหม่</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="custom-tabs-one-profile-tab" data-toggle="pill"
                                    href="#custom-tabs-one-profile" role="tab" aria-controls="custom-tabs-one-profile"
                                    aria-selected="false" onclick="tableOld_cus()">รายการต่ออายุ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="custom-tabs-one-messages-tab" data-toggle="pill"
                                    href="#custom-tabs-one-messages" role="tab" aria-controls="custom-tabs-one-messages"
                                    aria-selected="false" onclick="tableCancle_cus(this)">ยกเลิกสมาชิก</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" id="custom-tabs-one-expired-card-tab" data-toggle="pill"
                                    href="#custom-tabs-one-expired-card" role="tab"
                                    aria-controls="custom-tabs-one-expired-card" aria-selected="false"
                                    onclick="table_expire()">บัตรหมดอายุ</a>
                            </li>

                            <li class="nav-item">
                                <a class="nav-link" id="custom-tabs-one-action-card1-tab" data-toggle="pill"
                                    href="#custom-tabs-one-action-card1" role="tab"
                                    aria-controls="custom-tabs-one-action-card" aria-selected="false"
                                    onclick="table_pending()">บัตรรอดำเนินการ</a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" id="list-select-parking-new" data-toggle="pill"
                                    href="#list-select-parking" role="tab" aria-controls="list-select-parking"
                                    aria-selected="false" onclick="tableReserve_cus()">รายการจองที่จอดรถ</a>
                            </li>
                        </ul>

                    </div>
                    
                    <div class="card-body">
                        <div class="tab-content" id="custom-tabs-one-tabContent">
                            <!--New register tab-->
                            <div class="tab-pane fade show active" id="custom-tabs-one-home" role="tabpanel"
                                aria-labelledby="custom-tabs-one-home-tab">
                                <table id="customer-list1" class="table table-bordered table-striped" style="width:100%"
                                    data-pagination="true">
                                    <thead>
                                        <tr>
                                            <th>NO</th>
                                            <th>รหัสบัตร</th>
                                            <th>วันที่สมัคร</th>
                                            <th>ชื่อลูกค้า</th>
                                            <th>นามสกุลลูกค้า</th>
                                            <th>เบอร์โทรติดต่อ</th>
                                            <th>สถานีลานจอดรถ MRTA</th>
                                            <th>จำนวนเดือน</th>
                                            <th>ค่ามัดจำบัตร</th>
                                            <th>ค่าบริการรวม</th>
                                            <th>เอกสารสำเนาบปช.</th>
                                            <th>เอกสารสำเนารถ</th>
                                            <th>เอกสารสำเนาบัตรรฟม.</th>
                                            <th>สถานะตรวจสอบ</th>
                                            <th>เลขที่คิว</th>
                                            <th>คิวที่รอ</th>
                                            <th>ช่องทางการชำระเงิน</th>
                                            <th>ช่องทางใช้งาน</th>
                                            <th>สถานะการชำระเงิน</th>
                                            <th>วันที่ชำระเงิน</th>
                                            <th>วันที่เริ่มใช้บริการ</th>
                                            <th>วันที่บัตรหมดอายุ</th>
                                            <th>วันที่อ่านบัตรล่าสุด</th>                   
                                            <th>การจัดการ</th>
                                            <th>เลขที่ใบเสร็จอย่างย่อ</th>
                                            <th>คืนเงินลูกค้า</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-list1_show">
                                        <div id="showdocModal" class="modal fade" role='dialog'>
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">เอกสาร: สำเนาบัตรประชาชน</h5>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-hidden="true">&times;</button>
                                                
                                                    </div>
                                                    <div class="modal-body">
                                                        <img id="img1" style="width: 90%; height:80%">
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-default"
                                                            data-dismiss="modal">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="showdocModalcar" class="modal fade" role='dialog'>
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">เอกสาร: สำเนาทะเบียนรถ</h5>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-hidden="true">&times;</button>
                                                       
                                                    </div>
                                                    <div class="modal-body">
                                                        <img id="img2" class="mySlides" style="width: 90%; height:80%">
                                                        <img id="img3" class="mySlides" style="width: 90%; height:80%">
                                                    </div>
                                                    <div class="modal-footer">
                                                   
                                                        <button id="leftclick" onclick="plusDivs(-1)">&#10094;</button>
                                                        <button  id="rightclick" onclick="plusDivs(1)">&#10095;</button>
                                             
                                                        <button type="button" class="btn btn-default"
                                                            data-dismiss="modal">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div id="showdocModalMRT" class="modal fade" role='dialog'>
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">เอกสาร: สำเนาบัตรรถไฟฟ้า</h5>
                                                        <button type="button" class="close" data-dismiss="modal"
                                                            aria-hidden="true">&times;</button>
                                                       
                                                    </div>
                                                    <div class="modal-body">
                                                        <img id="img4" style="width: 90%; height:80%">
                                                    
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" class="btn btn-default"
                                                            data-dismiss="modal">Close</button>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="modal fade" id="Modaledit" name="modalEdit" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                
                                                  
                                               
                                                    </div>
                                                    <div class="modal-body">
                                                     
                                                            <div class="form-group">
                                                                <input type="hidden" name="id" id="id">
                                                                
                                                                <label>สถานะตรวจสอบ:</label>
                                                                <input type="text" id="verify_" name="verify_status"
                                                                    list="verify" />
                                                                <datalist id="verify">
                                                                    <option>ผ่านการตรวจสอบ</option>
                                                                    <option>ไม่ผ่านการตรวจสอบ</option>
                                                                    <option>รอจองคิว</option>
                                                                    <option>รอให้คิว</option>
                                                                    <option>ยกเลิก</option>
                                                                </datalist>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>ช่องทางการชำระเงิน:</label>
                                                                <input type="text" id="payment_name" name="payment_name"
                                                                    list="paymentName" />
                                                                <datalist id="paymentName" >
                                                                    <option>เงินสด</option>
                                                                    <option>Qr code</option>
                                                                    <option>ผูกบัญชีธนาคาร</option>
                                                                    <option>บัตรเครดิต/เดบิต</option>
                                                                </datalist>

                                                            </div>
                                                            <div class="form-group">
                                                                <label>สถานะการชำระเงิน:</label>
                                                                <input type="text" id="payment_status1"
                                                                    name="payment_status1" list="paymentStatus" />
                                                                <datalist id="paymentStatus">
                                                                    <option>ชำระแล้ว</option>
                                                                    <option>ยังไม่ได้ชำระ</option>
                                                                </datalist>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>วันที่ชำระ:</label>
                                                                <input  class="form-control" name="payment_date" id="payment_date1">
                                                            </div>
                                                            <div class="form-group">
                                                                <label>วันที่อ่านบัตรล่าสุด:</label>
                                                                <input  class="form-control"
                                                                    name="card_last_read_date" id="card_last_read_date1">
                                                            </div>
                                                            <div class="form-group">
                                                                <label>หมายเหตุ:</label>
                                                                <input  class="form-control"
                                                                    name="card_last_read_date" id="comment_verify" >
                                                            </div>
                                                            <div class="form-group">
                                                                 <button class="btn btn-primary" type="submit" onclick="update_newCus()" data-dismiss="modal">อัปเดต</button>
                                                           
                                                              
                                                            </div>
                                                     
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="modal fade" id="Modaledit_no-receipt" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                      
                                                    </div>
                                                    <div class="modal-body">
                                                                                
                                                            <div class="form-group">
                                                                <label>เลขที่ใบเสร็จอย่างย่อ:</label>
                                                                <input type="hidden" id="receiptid">
                                                                <input type="text" class="form-control" name="receipt_no" id="receipt_no">
                                                            </div>
                                                            
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="updateReceipt()" data-dismiss="modal">อัปเดต</button>

                                                            </div>
                                                     
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="modal fade" id="Modaledit_inv" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                       
                                                    </div>
                                                    <div class="modal-body">
                                                                                
                                                            <div class="form-group">
                                                                
                                                                <input type="hidden" id="addr_id">
                                                                <label>ใบกำกับภาษีค่าบริการ:</label>
                                                                <input type="text" class="form-control" name="address_type_2" id="address_type_2">
                                                                <label>ใบกำกับภาษีค่ามัดจำ:</label>
                                                                <input type="text" class="form-control" name="deposit_address_type_2" id="deposit_address_type_2">
                                                            </div>
                                                            
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="update_addr()" data-dismiss="modal">อัปเดต</button>

                                                            </div>
                                                     
                                                    </div>
                                                </div>

                                            </div>
                                        </div>


                                    </tbody>
                                </table>
                            </div>


                            <div class="modal fade" id="voidModal" tabindex="-1" role="dialog" aria-labelledby="payModalLabel" aria-hidden="true">
                                <div class="modal-dialog" role="document">
                                    <div class="modal-content">
                                        <div class="text-right px-3 py-2 bg-content" style="border-radius: 5px 5px 0px 0px;">
                                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                <span aria-hidden="true">&times;</span>
                                            </button>
                                        </div>
                                        <div class="modal-body text-center bg-content">
                                            <div class="row">
                                                <div class="col-5"><img src="{{url_for('static', filename='image/employee.svg')}}"
                                                        class="my-2 img-fluid" width="100"></div>
                                                <div class="col-7 align-self-center text-left">คุณต้องการคืนเงินลูกค้าหรือไม่ ?</div>
                                            </div>
                                        </div>
                                        <div class="justify-content-center">
                                            <div class="row m-3">
                                                <label>หมายเหตุ:</label>
                                                <input type="text" class="form-control" id="void_comment" required>
                                            </div>
                                            <div class="row m-3">
                                                <div class="col-6 text-right">
                                                    <button type="button" class="btn btn-success w-75" data-toggle="modal" 
                                                         onclick="void_Fastpay()" data-dismiss="modal">ยืนยัน</button>
                                                </div>
                                                <div class="col-6 text-left">
                                                    <button type="button" class="btn btn-danger w-75" data-dismiss="modal">ยกเลิก</button>
                                                </div>
                                            </div>
                                         </div>
                                        </div>
                                    </div>
                                </div>




                            <!--renew tab-->
                            <div class="tab-pane fade" id="custom-tabs-one-profile" role="tabpanel"
                                aria-labelledby="custom-tabs-one-profile-tab">
                                <table id="customer-list_2" class="table table-bordered table-striped"
                                    style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>NO</th>
                                            <th>รหัสบัตร</th>
                                            <th>วันที่การใช้งาน</th>
                                            <th>ชื่อลูกค้า</th>
                                            <th>นามสกุลลูกค้า</th>
                                            <th>เบอร์โทรติดต่อ</th>
                                            <th>สถานีลานจอดรถ MRTA</th>
                                            <th>จำนวนเดือน</th>
                                            <th>ค่าบริการรวม</th>
                                            <th>ช่องทางการชำระเงิน</th>
                                            <th>ช่องทางใช้งาน</th>
                                            <th>สถานะการชำระเงิน</th>
                                            <th>วันที่ชำระเงิน</th>
                                            <th>วันเริ่มต้นใช้บริการ</th>
                                            <th>วันที่บัตรหมดอายุ</th>
                                            <th>วันที่อ่านบัตรล่าสุด</th>
                                            <th>การจัดการ</th>
                                            <th>เลขที่ใบเสร็จอย่างย่อ</th>
                                            <th>คืนเงินลูกค้า</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-list_2_show">

                                        <div class="modal fade bd-example-modal-lg" id="Modaledit2" tabindex="-1"
                                            role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                    </div>
                                                    <div class="modal-body">
                                                
                                                            <input type="hidden" name="id2" id="id2">
                                                            <label>ช่องทางการชำระเงิน:</label>
                                                            <input type="text" id="payment_name2" name="payment_name2"
                                                                list="paymentName2" >
                                                            <datalist id="paymentName2">
                                                                <option>เงินสด</option>
                                                                <option>Qr code</option>
                                                                <option>ผูกบัญชีธนาคาร</option>
                                                                <option>บัตรเครดิต/เดบิต</option>
                                                            </datalist>
                                                            <div class="form-group">
                                                                <label>สถานะการชำระเงิน:</label>
                                                                <input type="text" id="payment_status2"
                                                                    name="payment_status2" list="paymentStatus2" />
                                                                <datalist id="paymentStatus2">
                                                                    <option>ชำระแล้ว</option>
                                                                    <option>ยังไม่ได้ชำระ</option>
                                                                </datalist>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>วันที่ชำระเงินสด:</label>
                                                                <input  class="form-control"
                                                                    name="payment_date2" id="payment_date2">
                                                            </div>
                                                            <div class="form-group">
                                                                <label>วันที่อ่านบัตรล่าสุด:</label>
                                                                <input  class="form-control"
                                                                    name="card_last_read_date2" id="card_last_read_date2">
                                                            </div>
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="update_oldCus()"  data-dismiss="modal">อัปเดต</button>

                                                             
                                                            </div>
                                                      
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="modal fade" id="Modaledit_no-receipt2" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                       
                                                    </div>
                                                    <div class="modal-body">
                                                                                
                                                            <div class="form-group">
                                                                <label>เลขที่ใบเสร็จอย่างย่อ:</label>
                                                                <input type="hidden" id="receiptid">
                                                                <input type="text" class="form-control" name="receipt_no2" id="receipt_no2">
                                                            </div>
                                                            
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="updateReceipt()" data-dismiss="modal">อัปเดต</button>

                                                            </div>
                                                     
                                                    </div>
                                                </div>

                                            </div>
                                        </div>

                                        <div class="modal fade" id="Modaledit_inv2" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                       
                                                    </div>
                                                    <div class="modal-body">
                                                                                
                                                            <div class="form-group">
                                                                
                                                                <input type="hidden" id="addr_id2">
                                                                <label>ใบกำกับภาษีค่าบริการ:</label>
                                                                <input type="text" class="form-control" name="address_type_2" id="address_type_3">
                                                                <label>ใบกำกับภาษีค่ามัดจำ:</label>
                                                                <input type="text" class="form-control" name="deposit_address_type_2" id="deposit_address_type_3">
                                                            </div>
                                                            
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="update_addr2()" data-dismiss="modal">อัปเดต</button>

                                                            </div>
                                                     
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </tbody>
                                </table>
                            </div>

                            <div class="tab-pane fade" id="custom-tabs-one-messages" role="tabpanel"
                                aria-labelledby="custom-tabs-one-messages-tab">
                                <table id="customer-list_3" class="table table-bordered table-striped"
                                    style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>No</th>
                                            <th>รหัสบัตร</th>
                                            <th>วันที่สมัคร</th>
                                            <th>วันหมดอายุ</th>
                                            <th>ชื่อลูกค้า</th>
                                            <th>นามสกุลลูกค้า</th>
                                            <th>เบอร์โทร</th>
                                            <th>สถานีลานจอดรถ MRTA</th>
                                            <th>ค่ามัดจำบัตร</th>
                                            <th>สถานะคืนค่ามัดจำบัตร</th>
                                            <th>ช่องทางใช้งาน</th>
                                            <th>สถานะคืนบัตร</th>
                                            <th>หมายเหตุ</th>
                                            <th class="textbox" colspan="1">การจัดการ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-list_3_show">
                                        <div class="modal fade bd-example-modal-lg" id="Modaledit3" tabindex="-1"
                                            role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                    </div>
                                                    <div class="modal-body">
                                                       
                                                            <input type="hidden" name="id3" id="id3">
                                                            <label>คืนค่ามัดจำบัตร:</label>
                                                            <input type="text" id="depositStatus" name="depositStatus" list="deposit_status" />
                                                            <datalist id="deposit_status">
                                                                <option></option>
                                                                <option>คืนแล้ว</option>
                                                                <option>ยังไม่ได้คืน</option>
                                                            </datalist>
                                                            <div class="form-group">
                                                                <label>สถานะคืนบัตร:</label>
                                                                <input type="text" id="return_card1" name="return_card" list="returnCard" />
                                                                <datalist id="returnCard">
                                                                    <option>คืนแล้ว</option>
                                                                    <option>ยังไม่ได้คืน</option>
                                                                </datalist>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>หมายเหตุ:</label>
                                                                <input type="text" class="form-control" name="comment" id="comment1">
                                                            </div>

                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="update_cancleCus()"  data-dismiss="modal">อัปเดต</button>
                                                            </div>
                                            
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </tbody>
                                </table>
                            </div>

                            <!--Expired Tab-->
                            <div class="tab-pane fade" id="custom-tabs-one-expired-card" role="tabpanel"
                                aria-labelledby="custom-tabs-one-expired-card-tab">
                                <table id="customer-list_4" class="table table-bordered table-striped"
                                    style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>NO</th>
                                            <th>* รหัสบัตร</th>
                                            <th>วันที่สมัคร</th>
                                            <th>ชื่อลูกค้า</th>
                                            <th>นามสกุลลูกค้า</th>
                                            <th>เบอร์โทรติดต่อ</th>
                                            <th>สถานีลานจอดรถ MRTA</th>
                                            <th>วันที่อ่านบัตรล่าสุด</th>
                                            <th>วันที่หมดอายุ</th>
                                            <th>วันที่ครบกำหนด 7 วัน</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                    <tbody id="customer-list_4_show">

                                    </tbody>
                                </table>
                            </div>


                            <!--บัตรรอดำเนินการ-->
                            <div class="tab-pane fade" id="custom-tabs-one-action-card1" role="tabpanel"
                                aria-labelledby="custom-tabs-one-action-card1-tab">
                                <table id="customer-list_5" class="table table-bordered table-striped"
                                    style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>NO</th>
                                            <th>*รหัสบัตร</th>
                                            <th>วันที่สมัคร</th>
                                            <th>ชื่อลูกค้า</th>
                                            <th>นามสกุลลูกค้า</th>
                                            <th>เบอร์โทรติดต่อ</th>
                                            <th>สถานีลานจอดรถ MRTA</th>
                                            <th>วันที่ชำระ</th>
                                            <th>ช่องทางใช้งาน</th>
                                            <th>วันที่อ่านบัตรล่าสุด</th>
                                            <th>วันที่บัตรหมดอายุ</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-list_5_show">
                                    </tbody>
                                </table>
                            </div>

                            <!--รายการจองที่จอดรถ-->
                              <div class="tab-pane fade" id="list-select-parking" role="tabpanel"
                                aria-labelledby="list-select-parking-new">
                                <table id="customer-list_2" class="table table-bordered table-striped"
                                    style="width:100%">
                                    <thead>
                                        <tr>
                                            <th>NO</th>
                                            <!-- <th>รหัสบัตร</th> -->
                                            <th>วันที่การใช้งาน</th>
                                            <th>ชื่อลูกค้า</th>
                                            <th>นามสกุลลูกค้า</th>
                                            <th>เบอร์โทรติดต่อ</th>
                                            <th>สถานีลานจอดรถ MRTA</th>
                                            <!-- <th>จำนวนเดือน</th> -->
                                            <th>ค่าบริการรวม</th>
                                            <th>ช่องทางการชำระเงิน</th>
                                            <th>ช่องทางใช้งาน</th>
                                            <th>สถานะการชำระเงิน</th>
                                            <th>วันที่ชำระเงิน</th>
                                            <th>วันที่หมดอายุ</th>
                                            <th>พิมพ์ใบเสร็จ</th>
                                            <th>แก้ไขที่อยู่</th>
                                        </tr>
                                    </thead>
                                    <tbody id="customer-list_6_show">

                                        <div class="modal fade bd-example-modal-lg" id="Modaledit2" tabindex="-1"
                                            role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog modal-lg">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                    </div>
                                                    <div class="modal-body">
                                                
                                                            <input type="hidden" name="id2" id="id2">
                                                            <label>ช่องทางการชำระเงิน:</label>
                                                            <input type="text" id="payment_name2" name="payment_name2"
                                                                list="paymentName2" >
                                                            <datalist id="paymentName2">
                                                                <option>เงินสด</option>
                                                                <option>Qr code</option>
                                                                <option>ผูกบัญชีธนาคาร</option>
                                                                <option>บัตรเครดิต/เดบิต</option>
                                                            </datalist>
                                                            <div class="form-group">
                                                                <label>สถานะการชำระเงิน:</label>
                                                                <input type="text" id="payment_status2"
                                                                    name="payment_status2" list="paymentStatus2" />
                                                                <datalist id="paymentStatus2">
                                                                    <option>ชำระแล้ว</option>
                                                                    <option>ยังไม่ได้ชำระ</option>
                                                                </datalist>
                                                            </div>
                                                            <div class="form-group">
                                                                <label>วันที่ชำระเงินสด:</label>
                                                                <input  class="form-control"
                                                                    name="payment_date2" id="payment_date2">
                                                            </div>
                                                            <div class="form-group">
                                                                <label>วันที่อ่านบัตรล่าสุด:</label>
                                                                <input  class="form-control"
                                                                    name="card_last_read_date2" id="card_last_read_date2">
                                                            </div>
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="update_oldCus()"  data-dismiss="modal">อัปเดต</button>

                                                             
                                                            </div>
                                                      
                                                    </div>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="modal fade" id="Modaledit_no-receipt6" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
                                            aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">เลือกที่อยู่ในใบกำกับภาษี</h5>
                                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                        
                                                    </div>
                                                    <div class="modal-body">
                                                        <form>
                                                            <div class="form-group">
                                                            
                                                                <input type="radio" id="address_home" name="radio1" value="1">
                                                                <label for="vehicle1"> ที่อยู่บ้าน</label><br>
                                                                <input type="radio" id="address_company" name="radio1" value="2">
                                                                <label for="vehicle2"> ที่อยู่บริษัท</label><br>
                                                                <input type="hidden" id="editAddressId">
                                                
                                                            </div>
                                            
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="changeAddress()"
                                                                    data-dismiss="modal">แก้ไข</button>
                                            
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                        
                                            </div>
                                        </div>

                                        <div class="modal fade" id="Modaledit_inv6" tabindex="-1" role="dialog"
                                            aria-labelledby="exampleModalLabel" aria-hidden="true">
                                            <div class="modal-dialog">
                                                <div class="modal-content">
                                                    <div class="modal-header">
                                                        <h5 class="modal-title">อัปเดตข้อมูล</h5>
                                                        <button type="button" class="close"
                                                            data-dismiss="modal">&times;</button>
                                                       
                                                    </div>
                                                    <div class="modal-body">
                                                                                
                                                            <div class="form-group">
                                                                
                                                                <input type="hidden" id="addr_id2">
                                                                <label>ใบกำกับภาษีค่าบริการ:</label>
                                                                <input type="text" class="form-control" name="address_type_2" id="address_type_3">
                                                                <label>ใบกำกับภาษีค่ามัดจำ:</label>
                                                                <input type="text" class="form-control" name="deposit_address_type_2" id="deposit_address_type_3">
                                                            </div>
                                                            
                                                            <div class="form-group">
                                                                <button class="btn btn-primary" type="submit" onclick="update_addr2()" data-dismiss="modal">อัปเดต</button>

                                                            </div>
                                                     
                                                    </div>
                                                </div>

                                            </div>
                                        </div>
                                    </tbody>
                                </table>
                            </div>


                            <!--Pop up  เพิ่มรายการใหม่-->
                            <div class="card-body">
                                <table id="example" class="table table-bordered table-striped">
                                    <div class="modal fade bd-example-modal-lg" id="exampleModal-add" tabindex="-1"
                                        role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                        <div class="modal-dialog modal-lg" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header ">
                                                    <h5 class="modal-title " id="exampleModalLabel">เพิ่มรายการใหม่</h5>
                                                    <button type="button" class="close" data-dismiss="modal"
                                                        aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <form 
                                                        action="{{ url_for('dashboard') }}"
                                                        method="POST" 
                                                        id="new_client" 
                                                        enctype="multipart/form-data">
                                                        <div class="row">
                                                            <div class="col-md-10 mx-auto">

                                                                <!--filter card status-->
                                                                <div class="form-group row mt-2">
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>card status</label>
                                                                        <input type="text" class="form-control"
                                                                            id="card_status" name="card_status"
                                                                            placeholder="ข้อมูลการ์ด" readonly>
                                                                    </div>

                                                                    <!--search box-->
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>ค้นหา</label>
                                                                        <input type="text" id="form1"
                                                                            class="form-control" placeholder="ค้นหา"
                                                                            name="search" />
                                                                    </div>
                                                                </div>

                                                                <!--filter ประเภทให้บริการ-->
                                                                <div class="form-group row mt-2">
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>ประเภทบริการ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <select class="form-control" name="service_type"
                                                                            id="service_type" required>
                                                                            <option value=1>--ประเภทบริการ--</option>
                                                                            <option value='สมัครใหม่'>สมัครใหม่</option>
                                                                            <option value='ต่ออายุ'>ต่ออายุ</option>
                                                                            <option value='ยกเลิก'>ยกเลิก</option>
                                                                            <option value='บัตรหาย'>บัตรหาย</option>
                                                                        </select>
                                                                    </div>

                                                                    <!--filter ชื่อลานจอด-->
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>อาคาร/ลานจอด <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <select class="custom-select"
                                                                            name="parking_station" id="parking_station"
                                                                            required>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <input type="hidden" id="exp_date">
                                                                <input type="hidden" id="station_id">
                                                                <input type="hidden" id="check_status">
                                                                <input type="hidden" id="line_name">
                                                                <input type="hidden" id="fetch_status">
                                                                <input type="hidden" id="log_month">
                                                                <input type="hidden" id="log_service_start">
                                                                <!-- <input class="modalinput" type="hidden" id="" name=""
                                                            placeholder=""> -->


                                                                <div class="form-group row mt-2">
                                                                    <!--รหัสลูกค้า-->
                                                                    <!-- <div class="col-sm-6 mt-2">
                                                                <label for="inputCustomerID">รหัสลูกค้า</label>
                                                                <input type="text" class="form-control" id="cus_id"
                                                                    name="cus_id" placeholder="รหัสลูกค้า" required>
                                                            </div> -->

                                                                    <!--รหัสบัตร-->
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label for="inputCard_ID">รหัสบัตร</label>
                                                                        <input type="text" class="form-control"
                                                                            name="card_id" id="card_id"
                                                                            placeholder="รหัสบัตร" maxlength="8"
                                                                            onchange="check_dup(this)">
                                                                    </div>

                                                                    <!--ประเภทบัตร-->                                                                    
                                                                    <div class="col-sm-6 mt-1">
                                                                        <label>ประเภทบัตร <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <select class="form-control" id="vcard_type"
                                                                            name="vcard_type" required>
                                                                            <option value=1>--ประเภทบัตร--</option>
                                                                            <option value='AFC'>AFC</option>
                                                                            <option value='CIT'>CIT</option>
                                                                            <option value='JOWIT'>JOWIT</option>
                                                                            <option value='TAFF'>TAFF</option>
                                                                        </select>
                                                                    </div>          
                                                                    <!--รหัสบัตรเสริม  aof 15-09-64-->
                                                                    <div class="col-sm-6 mt-4 ml-3">                                                                                                     
                                                                        <input class="form-check-input" type="checkbox" name="vcard_type" 
                                                                        value='รหัสบัตรเสริม'/><h6>สิทธิชดเชย</h6>
                                                                        <!-- <select class="form-control" id=""
                                                                            name="vcard_type">
                                                                            <option value=1>--ประเภทบัตร--</option>
                                                                            <option value='รหัสบัตรเสริม'>รหัสบัตรเสริม</option>                              
                                                                        </select> -->
                                                                    </div>
                                                                </div>

                                                                <div class="form-group row mt-2">
                                                                    <!--วันที่สมัคร-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputRegisterdate">วันที่สมัคร</label>
                                                                        <input type="date" class="form-control"
                                                                            id="register_date" placeholder=""
                                                                            name="register_date" readonly> <!--ดึงข้อมูลจากหลังบ้าน auto-->
                                                                    </div>
                                                                    <br><br>
                                                                    <!--บัตรประชาชน-->

                                                                    <div class="col-sm-6 mt-2" style="padding: 16px;">
                                                                        <label for="identity_card">บัตรประชาชน <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="text" class="form-control"
                                                                            id="identity_card" placeholder="บัตรประชาชน"
                                                                            name="identity_card" maxlength="13"
                                                                            required>
                                                                        <span class="error"></span>
                                                                    </div>
                                                                </div>

                                                                <!--ชื่่อลูกค้า-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="inputFirstname">ชื่อลูกค้า <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="text" class="form-control"
                                                                            id="name" placeholder="ชื่อลูกค้า"
                                                                            name="first_name_th" required>
                                                                    </div>

                                                                    <!--นามสกุล-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="inputLastname">นามสกุลลูกค้า <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="text" class="form-control"
                                                                            id="lastname" placeholder="นามสกุลลูกค้า"
                                                                            name="last_name_th" required>
                                                                    </div>
                                                                </div>


                                                                <div class="form-group row">
                                                                    <!--เบอร์์โทรศัพท์-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputContactNumber">เบอร์โทรติดต่อ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="text" class="form-control"
                                                                            id="phone" placeholder="เบอร์โทรติดต่อ"
                                                                            name="phone" maxlength="10" required>
                                                                    </div>
                                                                </div>

                                                                <div class="form-group row">
                                                                    <!--ที่อยู่บนใบกำกับค่ามัดจำ-->
                                                                    <div class="col-sm-12 mt-4">
                                                                        <label for="">เลือกประเภทข้อมูลสำหรับออกใบกำกับเต็มรูป</label>
                                                                    </div>
                                                                    
                                                                    <div class="col-sm-6 mt-4">
                                                                        <input class="form-check-input" type="radio" id="address_type"
                                                                        name="address_type" value="home" required/>
                                                                        <label for="">ข้อมูลที่อยู่ปัจจุบัน(บุคคลธรรมดา) <span
                                                                            class="text-valid" style="color: red;">*</span>
                                                                        </label>
                                                                    </div>

                                                                    <div class="col-sm-6 mt-4">
                                                                        <input class="form-check-input" type="radio" id="address_type2"
                                                                        name="address_type" value="company" required/>
                                                                        <label for="">ข้อมูลที่อยู่บริษัท(นิติบุคคล) <span
                                                                            class="text-valid" style="color: red;">*</span>
                                                                        </label>
                                                                    </div>
                                                                </div>   
                                                                
                                                                <div id="deposit_address_type" class="form-group row" hidden>
                                                                    <!--ที่อยู่บนใบกำกับค่ามัดจำ-->
                                                                    <div class="col-sm-12 mt-4">
                                                                        <label for="">เลือกประเภทข้อมูลสำหรับออกใบกำกับเต็มรูป(ค่ามัดจำ)</label>
                                                                    </div>
                                                                    
                                                                    <div class="col-sm-6 mt-4">
                                                                        <input class="form-check-input" type="radio" id="address_type_deposit"
                                                                        name="address_type_deposit" value="home" />
                                                                        <label for="">ข้อมูลที่อยู่ปัจจุบัน(บุคคลธรรมดา) <span
                                                                            class="text-valid" style="color: red;">*</span>
                                                                        </label>
                                                                    </div>

                                                                    <div class="col-sm-6 mt-4">
                                                                        <input class="form-check-input" type="radio" id="address_type_deposit2"
                                                                        name="address_type_deposit" value="company" />
                                                                        <label for="">ข้อมูลที่อยู่บริษัท(นิติบุคคล) <span
                                                                            class="text-valid" style="color: red;">*</span>
                                                                        </label>
                                                                    </div>
                                                                </div>

                                                                <div class="form-group row">
                                                                    <!-- <div class="col-sm-12 mt-4">
                                                                        <label>เลือกประเภทข้อมูลสำหรับออกใบกำกับเต็มรูป(ค่ามัดจำ)</label>
                                                                    </div> -->
                                                                    <!-- ข้อมูลที่อยู่ปัจจุบัน checkbox -->
                                                                    <div class="col-sm-6 mt-0">
                                                                        <!-- <input class="form-check-input" type="radio" id="address_type_deposit"
                                                                             name="address_type_deposit" value="home" required/>                                                                         -->
                                                                            <!-- onclick="setVisible('gridRadios1', true); setVisible('gridRadios2', false);"  ใส่ใน input -->
                                                                            <!-- <label for="">ข้อมูลที่อยู่ปัจจุบัน(บุคคลธรรมดา) <span
                                                                                class="text-valid" style="color: red;">*</span>
                                                                            </label> -->
                                                                        
                                                                        <!-- <label ></label> -->
                                                                        
                                                                        <div class="form-check1" id="gridRadios1">

                                                                            <br>
                                                                            <label>เลขที่ <span
                                                                                class="text-valid" style="color: red;">*</span></label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="address_no"
                                                                                placeholder="เลขที่" name="address_no">            
                                                                            <br>
                                                                            <label>หมู่</label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="village"
                                                                                placeholder="หมู่" name="village"
                                                                                >
                                                                            <br>
                                                                            <label>อาคาร</label> <!--เพิ่มใหม่-->
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="unit_home"
                                                                                placeholder="อาคาร" name="unit_home"  >      
                                                                            <br>
                                                                            <label>ซอย</label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="alley" placeholder="ซอย"
                                                                                name="alley">
                                                                            <br>
                                                                            <label>ถนน</label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="street"
                                                                                placeholder="ถนน" name="street">
                                                                            <br>
                                                                            <label>จังหวัด <span
                                                                                class="text-valid" style="color: red;">*</span></label>
                                                                            <select class="custom-select"
                                                                                name="province" id="province" value="" ></select>
                                                                               

                                                                            </select>
                                                                            <br>
                                                                            <label>อำเภอ/เขต <span 
                                                                                class="text-valid" style="color: red;">*</span></label>
                                                                            <select class="custom-select"
                                                                                name="district" id="district" value="">                                                                          
                                                                            </select>
                                                                            <br>
                                                                            <label>ตำบล/แขวง <span
                                                                                class="text-valid" style="color: red;">*</span></label>
                                                                            <select class="custom-select"
                                                                                name="sub_district" id="sub_district"
                                                                                value="">
                                                                            </select>
                                                                            <br>
                                                                            <label>รหัสไปรษณีย์ <span
                                                                                class="text-valid" style="color: red;">*</span></label>
                                                                            <select class="custom-select"
                                                                                name="postal_code" id="postal_code"
                                                                                value="" >

                                                                            </select>


                                                                        </div>
                                                                    </div>

                                                                    <!-- ข้อมูลที่อยู่บริษัท checkbox -->
                                                                    <div class="col-sm-6 mt-0">
                                                                        <!-- <input class="form-check-input" type="radio" id="address_type_deposit2"
                                                                              name="address_type_deposit" value="company" required/> -->
                                                                            <!-- onclick="setVisible('gridRadios2', true); setVisible('gridRadios1', false);" ใส่ใน input -->
                                                                            <!-- <label for="">ข้อมูลที่อยู่บริษัท(นิติบุคคล) <span
                                                                                class="text-valid" style="color: red;">*</span>
                                                                            </label> -->
                                                                        <div class="form-check2" id="gridRadios2">
                                                                            
                                                                            <br>
                                                                            <label>เลขที่ผู้เสียภาษี </label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="identity_com"
                                                                                placeholder="เลขที่ผู้เสียภาษี"
                                                                                name="identity_com">
                                                                            <br>
                                                                            <label>ชื่อบริษัท </label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="company_name"
                                                                                placeholder="บริษัท"
                                                                                name="company_name">
                                                                            <br>
                                                                            <label>เลขที่ </label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="company_no"
                                                                                placeholder="เลขที่" name="company_no">
                                                                            <br>
                                                                            <label>อาคาร </label> <!--เพิ่มใหม่-->
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="company_unit"
                                                                                placeholder="อาคาร" name="company_unit">    
                                                                            <br>
                                                                            <label>หมู่</label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="company_village"
                                                                                placeholder="หมู่"
                                                                                name="company_village">
                                                                            <br>
                                                                            <label>ซอย</label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="company_alley"
                                                                                placeholder="ซอย" name="company_alley">
                                                                            <br>
                                                                            <label>ถนน</label>
                                                                            <input class="form-control col-lg-12"
                                                                                type="text" id="company_street"
                                                                                placeholder="ถนน" name="company_street">
                                                                            <br>
                                                                            <label>จังหวัด </label>
                                                                            <select class="custom-select"
                                                                                name="company_province"
                                                                                id="company_province" value="">

                                                                            </select>
                                                                            <br>
                                                                            <label>อำเภอ/เขต </label>
                                                                            <select class="custom-select"
                                                                                name="company_district"
                                                                                id="company_district" value="">

                                                                            </select>
                                                                            <br>
                                                                            <label>ตำบล/แขวง </label>
                                                                            <select class="custom-select"
                                                                                name="company_sub_district"
                                                                                id="company_sub_district" value="">

                                                                            </select>
                                                                            <br>
                                                                            <label>รหัสไปรษณีย์ </label>
                                                                            <select class="custom-select"
                                                                                name="company_postal_code"
                                                                                id="company_postal_code" value="">

                                                                            </select>

                                                                        </div>
                                                                    </div>

                                                                </div>

                                                                <div class="form-group row">

                                                                    <!--ข้อมูลรถยนตร์ ป้ายทะเบียนคันที่ 1-->
                                                                    <div class="col-sm-6 mt-2">
                                                                        <div class="titlecar">
                                                                            <label for="titlecar1">ข้อมูลป้ายทะเบียน
                                                                                คันที่ 1</label>
                                                                        </div>

                                                                        <label for="car_registration">ทะเบียนรถ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="text" class="form-control"
                                                                            id="license_plate1"
                                                                            placeholder="ป้ายทะเบียนรถ"
                                                                            name="license_plate1" maxlength="7"
                                                                            required>
                                                                    </div>
                                                                    <div class="col-sm-6 mt-2" style="padding: 30px;">
                                                                        <label>จังหวัดบนป้ายทะเบียน <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <select class="custom-select"
                                                                            name="province_car1" id="province_car1"
                                                                            value="" required>

                                                                        </select>
                                                                    </div>
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>ยี่ห้อรถ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <select type="text" class="custom-select"
                                                                            name="brand_name1" id="brand_name1" value=""
                                                                            placeholder="ยี่ห้อรถ" required>
                                                                        </select>
                                                                    </div>
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>สีรถ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="text" class="form-control"
                                                                            name="color1" id="color1" value=""
                                                                            placeholder="สีรถ" required>
                                                                    </div>

                                                                    <br><br><br><br>
                                                                    <!--ข้อมูลรถยนตร์ ป้ายทะเบียนคันที่ 2-->
                                                                    <div class="col-sm-6 mt-2">
                                                                        <div class="titlecar">
                                                                            <label for="titlecar2" >ข้อมูลป้ายทะเบียน
                                                                                คันที่ 2</label>
                                                                        </div>

                                                                        <label for="car_registration2">ทะเบียนรถ</label>
                                                                        <input type="text" class="form-control"
                                                                            id="license_plate2"
                                                                            placeholder="ป้ายทะเบียนรถ"
                                                                            name="license_plate2" maxlength="7">
                                                                    </div>
                                                                    <div class="col-sm-6 mt-2" style="padding: 30px;">
                                                                        <label>จังหวัดบนป้ายทะเบียน</label>
                                                                        <select class="custom-select"
                                                                            name="province_car2" id="province_car2"
                                                                            value="">

                                                                        </select>
                                                                    </div>
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>ยี่ห้อรถ</label>
                                                                        <select type="text" class="custom-select"
                                                                            name="brand_name2" id="brand_name2"
                                                                            value="" placeholder="ยี่ห้อรถ">
                                                                        </select>
                                                                    </div>
                                                                    <div class="col-sm-6 mt-2">
                                                                        <label>สีรถ</label>
                                                                        <input type="text" class="form-control"
                                                                            name="color2" id="color2" value=""
                                                                            placeholder="สีรถ">
                                                                    </div>


                                                                </div>

                                                                <div id="deposit_checking" class="form-group row" hidden>
                                                                    <div >
                                                                        กรณีลูกค้ามีบัตรอยู่แล้ว (ยกเลิกค่ามัดจำ): <input id="depositcheckbox" value="off" type="checkbox">
                                                                    </div>
                                                                </div>

                                                                <div class="form-group row">
                                                                    <input type="hidden" id="vcard_type"
                                                                        name="vcard_type">
                                                                    <!-- ประเภทบัตร
                                                                    <div class="col-sm-4 mt-4">
                                                                        <label>ประเภทบัตร</label>
                                                                        <select class="form-control" id="vcard_type"
                                                                            name="vcard_type" required>
                                                                            <option value=1>--ประเภทบัตร--</option>
                                                                            <option value='AFC'>AFC</option>
                                                                            <option value='CIT'>CIT</option>
                                                                            <option value='JOWIT'>JOWIT</option>
                                                                            <option value='TAFF'>TAFF</option>
                                                                        </select>
                                                                    </div> -->

                                                                    <!--จำนวนเดือน-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputContactNumber">จำนวนเดือน <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="number" class="form-control"
                                                                            id="inputmonths" placeholder="จำนวนเดือน"
                                                                            name="inputmonths" required>
                                                                    </div>

                                                                    <!--วันที่เริ่มต้น-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputContactNumber">วันที่เริ่มต้น <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="date" class="form-control"
                                                                            id="inputdate" placeholder="จำนวนเดือน"
                                                                            name="inputdate" required>
                                                                    </div>
                                                                </div>

                                                                <!--ค่ามัดจำยัตร-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-4 mt-4">
                                                                        <label for="inputdeposit">ค่ามัดจำบัตร </label>
                                                                        <input type="text" class="form-control"
                                                                            id="deposit" name="deposit"
                                                                            placeholder="ค่ามัดจำ" readonly>
                                                                    </div>

                                                                    <!--ค่าบริการ-->
                                                                    <div class="col-sm-4 mt-4">
                                                                        <label for="inputService">ค่าบริการ</label>
                                                                        <input type="text" class="form-control"
                                                                            id="price" placeholder="ค่าบริการ"
                                                                            name="price" readonly>
                                                                    </div>

                                                                    <!--Vat-->
                                                                    <!-- <div class="col-sm-3 mt-4">
                                                                        <label for="inputVat">Vat.</label>
                                                                        <input type="text" class="form-control" id="vat"
                                                                            placeholder="Vat." readonly>
                                                                    </div> -->

                                                                    <!--ค่าบริการรวม-->
                                                                    <div class="col-sm-4 mt-4">
                                                                        <label for="inputNet">ค่าบริการรวม</label>
                                                                        <input type="text" class="form-control"
                                                                            placeholder="ค่าบริการรวม" id="total"
                                                                            name="total" readonly>
                                                                    </div>
                                                                </div>

                                                                <!--เอกสารสำเนาบัตรปชช.-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputIdcard">เอกสารสำเนาบัตรปชช. <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="file" class="" id="copy_id_card"
                                                                            name="copy_id_card" placeholder=""
                                                                            onchange='validateSize(this)' required>
                                                                    </div>

                                                                    <!--เอกสารสำเนารถ-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="inputcopycar">เอกสารสำเนารถ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="file" class="" placeholder=""
                                                                            id="copy_doc_car1" name="copy_doc_car1"
                                                                            onchange='validateSize(this)' required>
                                                                    </div>
                                                                </div>

                                                                <!--สถานะตรวจสอบ-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="inputststus">สถานะตรวจสอบ <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <select id="status-select2" class="form-control"
                                                                            name="status-select2">
                                                                            <option value="">--สถานะตรวจสอบ--</option>
                                                                            <option value="1">ผ่านการตรวจสอบ</option>
                                                                            <option value="2">ไม่ผ่านการตรวจสอบ</option>
                                                                            <option value="3">รอจองคิว</option>
                                                                            <option value="4">จองคิว</option>
                                                                            <option value="5">ยกเลิก</option>
                                                                        </select>
                                                                    </div>

                                                                    <!--แจ้งเตืือน-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="inputnotice">แจ้งเตือน </label>
                                                                        <input type="text" class="form-control"
                                                                            placeholder="แจ้งเตือน" id="notification"
                                                                            name="notification">
                                                                    </div>
                                                                </div>

                                                                <!--ช่องทางการชำระเงิน-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label>ช่องทางการชำระเงิน</label>
                                                                        <select id="payment_name3" name="payment_name3"
                                                                            class="form-control">
                                                                            <option value="">--ช่องทางการชำระเงิน--
                                                                            </option>
                                                                            <option value="1">เงินสด</option>
                                                                            <option value="2">บัตรเครดิต</option>
                                                                            <option value="5">เช็คธนาคาร</option>
                                                                        </select>
                                                                    </div>

                                                                    <!--สถานะการชำระเงิน-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label>สถานะการชำระเงิน</label>
                                                                        <select id="payment_status"
                                                                            name="payment_status" class="form-control">
                                                                            <option value="">--สถานะการชำระเงิน--</option>                                          
                                                                            <option value="1">ชำระเงิน</option>
                                                                            <option value="0">ไม่ชำระเงิน
                                                                            </option>
                                                                        </select>
                                                                    </div>
                                                                </div>
                                                                <!--เช็ค-->
                                                                <div id="cheque1" hidden class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label>เลขที่เช็ค</label>
                                                                        <input type="text" id="cheque_no" class="form-control" name="cheque_no">
                                                                    </div>

                                                                    <!--สถานะการชำระเงิน-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label>วันที่ออกเช็ค</label>
                                                                        <input type="date" id="cheque_date" class="form-control" name="cheque_date">
                                                                    </div>
                                                                </div>

                                                                <div id="cheque2" hidden class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label>ชื่อธนาคารที่ออกเช็ค</label>
                                                                        <input type="text" id="bank_name" class="form-control" name="bank_name">
                                                                    </div>

                                                                    <!--สถานะการชำระเงิน-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label>สาขาธนาคารที่ออกเช็ค</label>
                                                                        <input type="text" id="bank_branch" class="form-control" name="bank_branch">
                                                                    </div>
                                                                </div>


                                                                <!--วันที่ชำระเงิน-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputPaymentdate">วันที่ชำระเงิน <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="datetime-local" id="payment_date"
                                                                            name="payment_date" class="form-control"
                                                                            placeholder="">
                                                                    </div>

                                                                    <!--วันที่อ่านบัตรล่าสุด-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label
                                                                            for="inputLastestdate">วันที่อ่านบัตรล่าสุด <span
                                                                            class="text-valid" style="color: red;">*</span></label>
                                                                        <input type="date" id="card_last_read_date"
                                                                            name="card_last_read_date"
                                                                            class="form-control" placeholder=""
                                                                            required>
                                                                    </div>
                                                                </div>
                                                                
                                                                <!--จำนวนค่ามัดจำ-->
                                                                <div hidden id="deposit_return" class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="deposit_return">จำนวนเงินคืนค่ามัดจำ</label>
                                                                        <input type="้text" class="form-control"  name="deposit_return">
                                                                    </div>
                                                                </div>
                                                                
                                                                <!--สถานะคืนบัตร-->
                                                                <div class="form-group row">
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="">สถานะคืนบัตร</label>
                                                                        <select class="form-control" id="return_card_2"
                                                                            name="return_card_2">
                                                                            <option value="">--กรุณาเลือก--</option>
                                                                            <option value="1">คืนบัตร</option>
                                                                            <option value="0">ยังไม่คืนบัตร</option>
                                                                        </select>
                                                                    </div>

                                                                    <!--หมายเหตุ-->
                                                                    <div class="col-sm-6 mt-4">
                                                                        <label for="inputNote">หมายเหตุ</label>
                                                                        <input type="text" id="comment" name="comment"
                                                                            class="form-control" placeholder="">
                                                                    </div>
                                                                </div>

                                                                <div class="col-md-12 text-center">
                                                                    <button type="button" class="btn btn-secondary ml-2"
                                                                        data-dismiss="modal">ยกเลิก</button>
                                                                    <button type="submit" class="btn btn-primary ml-2"
                                                                        class="fas fa-save" >บันทึกข้อมูล</button>
                                                                   
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </table>

                            </div>

                            <!-- {% include "manage/comps/footer.html" %} -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script type="text/javascript" src="{{ url_for('static', filename='js/manage/AutoPark.js') }}"></script>
<script>
    $('body').AutoPark({
        LINE: '#line',
        PARK: '#park'
    });


    $("#search").on("keyup", function() {
    var value = $(this).val();

    $("tbody tr").each(function(index) {
        if (index !== 0) {

            $row = $(this);

            var id = $row.find("td:nth-child(2)").text();

            if (id.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }
        }
    });
 });
function reset_tr(){
    $("tbody tr").each(function(index) {
        if (index !== 0) {

            $row = $(this);
            $row.show();
            
        }
    });
}

 $("#filter_verify").on("click", function() {
    reset_tr();
    var value = $(this).val();
  if(value=="--สถานะตรวจสอบ--"){
    reset_tr();
  }
  if(filename == "รายการสมัครใหม่"){
      if(value == "ผ่านการตรวจสอบ" || value == "ไม่ผ่านการตรวจสอบ"){
    $("tbody tr").each(function(index) {
     
        if (index !== 0) {

            $row = $(this);

            var id = $row.find("td:nth-child(15)").text();

            if (id.indexOf(value) !== 0) {
                $row.hide();
            }
            else {
                $row.show();
            }
        }
    });
    }
   }


 });
 
 $("#filter_payment").on("click", function() {
    reset_tr();
    var value = $(this).val();
    if(value=="--ช่องทางชำระ--"){
    reset_tr();
  }
  else  if(filename == "รายการสมัครใหม่"){ 
     
    $("tbody tr").each(function(index) {
        if (index !== 0) {
            $row = $(this);
          
            var id = $row.find("td:nth-child(18)").text();
       
            if (id.indexOf(value) !== 0) {
                $row.hide();
            }
          
            else {
                $row.show();
            }
        }
    });
   }
 else  if(filename == "รายการต่ออายุ"){ 
     $("tbody tr").each(function(index) {
         if (index !== 0) {
             $row = $(this)
             var id = $row.find("td:nth-child(11)").text();
             
             if (id.indexOf(value) !== 0) {
                 $row.hide();
             }
             else {
                 $row.show();
             }
          
         }
  
     });
    }

    
 });
 $("#filter_paystatus").on("click", function() {
    reset_tr();
    var value = $(this).val();
    if(value=="--สถานะชำระเงิน--"){
    reset_tr();
  }
  else  if(filename == "รายการสมัครใหม่"){ 
     
    $("tbody tr").each(function(index) {
        if (index !== 0) {
            $row = $(this);
          
            var id = $row.find("td:nth-child(19)").text();
       
            if (id.indexOf(value) !== 0) {
                $row.hide();
            }
          
            else {
                $row.show();
            }
        }
    });
   }
 else  if(filename == "รายการต่ออายุ"){ 
     $("tbody tr").each(function(index) {
         if (index !== 0) {
             $row = $(this)
             var id = $row.find("td:nth-child(12)").text();
             
             if (id.indexOf(value) !== 0) {
                 $row.hide();
             }
             else {
                 $row.show();
             }
          
         }
  
     });
    }

    
 });


  document.getElementById('payment_name').onchange = function() {

    if(this.value!='เงินสด'){
            if(checkNull==1){
             document.getElementById('payment_date1').value = "";
            }
            document.getElementById('payment_status1').readOnly = true;
            document.getElementById('payment_date1').readOnly = true;
        }
        else{
            document.getElementById('payment_status1').readOnly = false;
            document.getElementById('payment_date1').readOnly = false;
        }
  
 }

 document.getElementById('payment_name2').onchange = function() {

 if(this.value!='เงินสด'){
        //document.getElementById('payment_status2').readOnly = true;
        document.getElementById('payment_date2').readOnly = true;
    }
    else{
        document.getElementById('payment_status2').readOnly = false;
        document.getElementById('payment_date2').readOnly = false;
    }

}

var slideIndex = 1;
showDivs(slideIndex);

function plusDivs(n) {
  showDivs(slideIndex += n);
}

function showDivs(n) {
  var i;
  var x = document.getElementsByClassName("mySlides");
  if (n > x.length) {slideIndex = 1}
  if (n < 1) {slideIndex = x.length}
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";  
  }
  x[slideIndex-1].style.display = "block";  
}
var tableID,filename;
function exportTableToExcel(){
    var table = document.getElementById(tableID);
    var rows =[];
    var columns = document.getElementById(tableID).rows[0].cells.length
    if(filename=='รายการสมัครใหม่' || filename=='รายการต่ออายุ'){
        columns = columns - 3
    }
    else if(filename=='ยกเลิกสมาชิก'){
        columns = columns - 1
    }
    for(var i=0,row; row = table.rows[i];i++){
        for(j=0;j<columns;j++){
            if(j==0){
              line = row.cells[j].innerText;
            }
            else{
                line = line + ',' + row.cells[j].innerText;
            }
        
        }

        rows.push(
            [
               line
            ]
        );
 
    }
    
        csvContent = "data:text/csv;charset=utf-8,\uFEFF";
        rows.forEach(function(rowArray){
            row = rowArray.join(",");
            csvContent += row + "\r\n";
        });
 
       
        var encodedUri = encodeURI(csvContent);
        var link = document.createElement("a");
        link.setAttribute("href",csvContent,encodedUri);
        link.setAttribute("download",filename+'.csv');
        document.body.appendChild(link);
        link.click();
    
}

  
</script>


<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script> -->

<script>
    $(document).ready(function () {
        $('#validationPhone').on('keyup', function () {
            if ($.trim($(this).val()) != '' && $(this).val().length == 10) {
                id = $(this).val().replace(/-/g, "");
                var result = Script_checkID(id);
                if (result === false) {
                    $('span.error').removeClass('true').text('ท่านกรอกหมายเลขไม่ถูกต้อง');
                } else {
                    $('span.error').addClass('true').text('หมายเลขโทรศัพท์ถูกต้อง');
                }
            } else {
                $('span.error').removeClass('true').text('');

            }
        })
    });
    // ตรวจสอบตัวเลขโทรศัทพ์
    function Script_checkphone(id) {
        if (!IsNumeric(id)) return false;
        if (id.substring(0, 1) == 0) return false;
        if (id.length != 13) return false;
        for (i = 0, sum = 0; i < 9; i++)
            sum += parseFloat(id.charAt(i)) * (10 - i);
        if ((11 - sum % 11) % 10 != parseFloat(id.charAt(12))) return false;
        return true;
    }
    function IsNumeric(input) {
        var RE = /^-?(0|INF|(0[1-7][0-7]*)|(0x[0-9a-fA-F]+)|((0|[1-9][0-9]*|(?=[\.,]))([\.,][0-9]+)?([eE]-?\d+)?))$/;
        return (RE.test(input));
    }
</script>
<script>
    document.getElementById('depositcheckbox').onclick = () => {
        document.getElementById('deposit').value = 0
    }

    document.getElementById('payment_status').onchange = () => {
        const v = document.getElementById('payment_status').value;
        if (v == '0'){
            document.getElementById('payment_date').required = false;
        }else if (v == '1') {
            document.getElementById('payment_date').required = true;
        }else{
            document.getElementById('payment_date').required = false;
        }
    }
    async function search_status(station){

        let card_id = document.getElementById('form1').value
        console.log(card_id)
        console.log(station)
        await fetch('station_id/' + card_id + '/'+station).then(async function (response) {
            await response.json().then(function (data) {
                if (data.fetch_status == 'success'){
                    document.getElementById('station_id').value = data.parking_id
                    document.getElementById('check_status').value = data.status
                    document.getElementById('exp_date').value = data.card_expire_date
                    document.getElementById('fetch_status').value = data.fetch_status
                }else{
                    document.getElementById('fetch_status').value = data.fetch_status
                }
                
            })
        })
    }
    
    async function getData(station) {
        id_ = document.getElementById('form1').value;
        await fetch('card_id_/' + id_+'/'+station).then(async function (response) {
        await response.json().then(async function (data) {
                optionHTML2 = ''
                for (brand of data.brand) {
                    optionHTML2 += '<option value="' + brand.brand + '">' + brand.brand + '</option>'
                }
                //user
                document.getElementById('card_id').value = data.card_id
                //document.getElementById('cus_id').value = data.cus_id
                document.getElementById('name').value = data.first_name
                document.getElementById('lastname').value = data.last_name
                document.getElementById('phone').value = data.phone
                document.getElementById('identity_card').value = data.identity_card
                //address home
                document.getElementById('unit_home').value = data.unit_home
                document.getElementById('address_no').value = data.address_no
                document.getElementById('village').value = data.village
                document.getElementById('alley').value = data.alley
                document.getElementById('street').value = data.street
                document.getElementById('province').value = data.province
                document.getElementById('log_month').value = data.log_month
                console.log(document.getElementById('log_month').value)
                document.getElementById('log_service_start').value = data.log_service_start
                console.log(document.getElementById('log_service_start').value)
                await fetch('district/' + data.province).then(async function(response){
                    await response.json().then(function(data){
                     optionHTML = '';
                     for (district of data.districtlist){
                      optionHTML += '<option value="' + district.name +'">' + district.name+ '</option>'
                     }
                     document.getElementById('district').innerHTML = optionHTML;
                    });
                   });
                document.getElementById('district').value = data.district
                await fetch('subdistrict/'+data.province+'/' + data.district).then(async function(response){
                    await response.json().then(function(data){
                     optionHTML = '';
                     for (sub of data.subdistrictlist){
                      optionHTML += '<option value="' + sub +'">' + sub + '</option>'
                     }
                     document.getElementById('sub_district').innerHTML = optionHTML;
                    });
                   });
                document.getElementById('sub_district').value = data.sub_district
                await fetch('postcode/'+data.province+'/' + data.district+'/' + data.sub_district).then(async function(response){
                    await response.json().then(function(data){
                     optionHTML = '';
                     for (post of data.postcodelist){
                      optionHTML += '<option value="' + post +'">' + post + '</option>'
                     }
                     document.getElementById('postal_code').innerHTML = optionHTML;
                    });
                   });
                document.getElementById('postal_code').value = data.postal_code
                // address company
                document.getElementById('company_unit').value = data.company_unit
                document.getElementById('company_name').value = data.company_name
                document.getElementById('company_no').value = data.company_no
                document.getElementById('company_village').value = data.company_village
                document.getElementById('company_alley').value = data.company_alley
                document.getElementById('company_street').value = data.company_street
                document.getElementById('company_province').value = data.company_province
                await fetch('district/' + data.company_province).then(async function(response){
                    await response.json().then(function(data){
                     optionHTML = '';
                     for (district of data.districtlist){
                      optionHTML += '<option value="' + district.name +'">' + district.name+ '</option>'
                     }
                     document.getElementById('company_district').innerHTML = optionHTML;
                    });
                   });
                document.getElementById('company_district').value = data.company_district
                await fetch('subdistrict/'+data.company_province+'/' + data.company_district).then(async function(response){
                    await response.json().then(function(data){
                     optionHTML = '';
                     for (sub of data.subdistrictlist){
                      optionHTML += '<option value="' + sub +'">' + sub + '</option>'
                     }
                     document.getElementById('company_sub_district').innerHTML = optionHTML;
                    });
                   });
                document.getElementById('company_sub_district').value = data.company_sub_district
                await fetch('postcode/'+data.company_province+'/' + data.company_district+'/' + data.company_sub_district).then(async function(response){
                    await response.json().then(function(data){
                     optionHTML = '';
                     for (post of data.postcodelist){
                      optionHTML += '<option value="' + post +'">' + post + '</option>'
                     }
                     document.getElementById('company_postal_code').innerHTML = optionHTML;
                    });
                   });
                document.getElementById('company_postal_code').value = data.company_postal_code

                //car1
                document.getElementById('license_plate1').value = data.license_plate1
                document.getElementById('province_car1').value = data.province_car1
                document.getElementById('color1').value = data.color1
                document.getElementById('brand_name1').innerHTML = '<option value="' + data.brand_name1 + '">' + data.brand_name1 + '</option>' + optionHTML2
                //car2
                document.getElementById('license_plate2').value = data.license_plate2
                document.getElementById('province_car2').value = data.province_car2
                document.getElementById('color2').value = data.color2
                document.getElementById('brand_name2').innerHTML = '<option value="' + data.brand_name2 + '">' + data.brand_name2 + '</option>' + optionHTML2

                //status
                document.getElementById('check_status').value = data.status
                document.getElementById('line_name').value = data.line_name
                document.getElementById('card_status').value = data.status
                document.getElementById('exp_date').value = data.card_expire_date
            })
        })
    }
</script>
<script>
    document.getElementById('inputmonths').addEventListener('change', function () {
        const total_price = document.getElementById('total')
        const station_price = document.getElementById('price').value
        const station_deposit = document.getElementById('deposit').value
        const total = (Number(station_price) * Number(this.value)) + Number(station_deposit)
        total_price.value = total
        total_price.placeholder = total
    })
</script>
<script>//ที่อยู่ปัจุบัน ที่อยู่บริษัท สำหรับเลือกอย่างใดอย่างหนึ่ง
    function setVisible(id, visible) {
        var o = document.getElementById(id); //get the element based on it's id

        //if the element exists then set it's visiblity
        if (isElement(o)) {
            o.style.visibility = visible ? 'visible' : 'hidden';
        } else {
            alert("Element with id '" + id + "' not found.");
        }
    }

    function setDisplay(id, visible) {
        var o = document.getElementById(id);
        if (isElement(o)) {
            o.style.display = visible ? 'block' : 'none';
        } else {
            alert("Element with id '" + id + "' not found.");
        }
    }

    function isElement(obj) {
        var returnValue = false;
        if (obj == undefined || obj == null) {
            returnValue = false;
        } else {
            returnValue = true;
        }
        return returnValue;
    }
</script>

<script>
    function customSelect() {
        province_select = document.getElementById('province');
        district_select = document.getElementById('district');
        subdistrict_select = document.getElementById('sub_district');
        postcode_select = document.getElementById('postal_code');
        province_select2 = document.getElementById('company_province');
        district_select2 = document.getElementById('company_district');
        subdistrict_select2 = document.getElementById('company_sub_district');
        postcode_select2 = document.getElementById('company_postal_code');
        station_select = document.getElementById('parking_station');
        verify_select = document.getElementById('status-select2');
        payment_select = document.getElementById('payment_name3');
        brand1_select = document.getElementById('brand_name1');
        brand2_select = document.getElementById('brand_name2');
        district_select.innerHTML = ''
        sub_district.innerHTML = ''
        postal_code.innerHTML = ''
        company_district.innerHTML = ''
        company_sub_district.innerHTML = ''
        company_postal_code.innerHTML = ''
        fetch('brand_name').then(function (response) {
            response.json().then(function (data) {
                optionHTML = '';
                for (brand of data) {
                    optionHTML += '<option value="' + brand.brand + '">' + brand.brand + '</option>'
                }
                brand1_select.innerHTML = optionHTML;
                brand2_select.innerHTML = optionHTML;
            })
        })
        fetch('station').then(function (response) {
            response.json().then(function (data) {
                optionHTML = '';
                for (station of data.station) {
                    optionHTML += '<option value="' + station.id + '">' + station.name + '</option>'
                }
                station_select.innerHTML = optionHTML;
                optionHTML = ''
                //for (verify of data.verify_status) {
                //    optionHTML += '<option value="' + verify.id + '">' + verify.name + '</option>'
                //}
                //verify_select.innerHTML = optionHTML;
                //optionHTML = ''
                //for (payment of data.payment_name) {
                //    optionHTML += '<option value="' + payment.id + '">' + payment.name + '</option>'
                //}
                //payment_select.innerHTML = optionHTML;
            })
        })
        fetch('province').then(function (response) {
            response.json().then(function (data1) {
                optionHTML = '';
                for (province of data1.province) {
                    optionHTML += '<option value="' + province + '">' + province + '</option>'
                }
                province_select.innerHTML = optionHTML;
                province_select2.innerHTML = optionHTML;
                document.getElementById('province_car1').innerHTML = optionHTML;
                document.getElementById('province_car2').innerHTML = optionHTML
            })
        })
        province_select.onchange = function () {
            province = province_select.value;
            fetch('district/' + province).then(function (response) {
                response.json().then(function (data3) {
                    optionHTML = '';
                    for (district of data3.districtlist) {
                        optionHTML += '<option value="' + district.name + '">' + district.name + '</option>'
                    }
                    district_select.innerHTML = optionHTML;
                });
            });
        }
        district_select.onchange = function(){
            district = district_select.value; 
            province = province_select.value;
            fetch('subdistrict/'+province +'/' + district).then(function(response){
             response.json().then(function(data){
              optionHTML = '';
              for (sub of data.subdistrictlist){
               optionHTML += '<option value="' + sub +'">' + sub + '</option>'
              }
              subdistrict_select.innerHTML = optionHTML;
             });
            });
           }
           subdistrict_select.onchange = function(){
            subdistrict = subdistrict_select.value;
            province = province_select.value;
            district_ = district_select.value;
            fetch('postcode/' +province+'/'+district_+'/'+ subdistrict).then(function(response){
             response.json().then(function(data){
              optionHTML = '';
              for (post of data.postcodelist){
               optionHTML += '<option value="' + post +'">' + post + '</option>'
              }
              postcode_select.innerHTML = optionHTML;
             });
            });
           }
        province_select2.onchange = function () {
            province = province_select2.value;
            fetch('district/' + province).then(function (response) {
                response.json().then(function (data7) {
                    optionHTML = '';
                    for (district of data7.districtlist) {
                        optionHTML += '<option value="' + district.name + '">' + district.name + '</option>'
                    }
                    district_select2.innerHTML = optionHTML;
                });
            });
        }
        district_select2.onchange = function(){
            district = district_select2.value; 
            province = province_select2.value;
            fetch('subdistrict/'+province+'/' + district).then(function(response){
             response.json().then(function(data){
              optionHTML = '';
              for (sub of data.subdistrictlist){
               optionHTML += '<option value="' + sub +'">' + sub + '</option>'
              }
              subdistrict_select2.innerHTML = optionHTML;
             });
            });
           }
        subdistrict_select2.onchange = function(){
        subdistrict = subdistrict_select2.value;
        district = district_select2.value; 
        province = province_select2.value; 
        fetch('postcode/'+province +'/'+district+'/' + subdistrict).then(function(response){
         response.json().then(function(data){
          optionHTML = '';
          for (post of data.postcodelist){
           optionHTML += '<option value="' + post +'">' + post + '</option>'
          }
          postcode_select2.innerHTML = optionHTML;
         });
        });
       }}
    function getStatus() {
        console.log(document.getElementById('form1').value)
        fetch('status/' + document.getElementById('form1').value).then(function (response) {
            response.json().then(function (data10) {
                document.getElementById('status-select2').value = data10.verify_status
                document.getElementById('payment_name3').value = data10.payment_name 
            })
        })
    }

    //----------------------------------------------------------------------------------------

    document.getElementById('parking_station').onchange = async function () {
        station = document.getElementById('parking_station').value;
        let service_type = document.getElementById('service_type').value
        if (service_type !=='สมัครใหม่'){
            await search_status(station)
        }
        
        if (document.getElementById('fetch_status').value !== 'faill'){
            fetch('total/' + station).then(function (response) {
            response.json().then(async function (data2) {
                if (service_type === 'สมัครใหม่') {
                    //document.getElementById('status-select2').disabled = false;
                    //document.getElementById('payment_name3').disabled = false;
                    document.getElementById('copy_id_card').required = true;
                    document.getElementById('copy_doc_car1').required = true;
                    if(data2.deposit !== 0){
                        document.getElementById('deposit_checking').hidden = false
                        document.getElementById('deposit_address_type').hidden = false
                        document.getElementById('address_type_deposit').setAttribute('required',true)
                        document.getElementById('address_type_deposit').setAttribute('required',true)
                    }else{
                        document.getElementById('deposit_checking').hidden = true
                        document.getElementById('deposit_address_type').hidden = true
                        document.getElementById('address_type_deposit').removeAttribute('required')
                        document.getElementById('address_type_deposit').removeAttribute('required')
                    }
                    document.getElementById('deposit').value = data2.deposit
                    // document.getElementById('deposit').placeholder = data2.deposit
                    document.getElementById('price').value = data2.price
                    // document.getElementById('price').placeholder = data2.price
                    document.getElementById('line_name').value = data2.line_name
                    document.getElementById('vcard_type').innerHTML = '<option value="' + data2.vcard_type + '">' + data2.vcard_type + '</option>'
                    if (document.getElementById('vcard_type').value === 'TAFF') {
                        document.getElementById('inputmonths').max = 12
                        document.getElementById('inputmonths').min = 0
                    } else {
                        document.getElementById('inputmonths').max = 1
                        document.getElementById('inputmonths').min = 0
                    }
                    if (document.getElementById('line_name').value === 'สายสีม่วง') {
                        document.getElementById('inputdate').max = new Date().toISOString().split("T")[0];
                        document.getElementById('inputdate').min = new Date().toISOString().split("T")[0];
                    } else {
                        document.getElementById('inputdate').min = new Date().toISOString().split("T")[0];
                        document.getElementById('inputdate').max = new Date(new Date().setDate(new Date().getDate() + 7)).toISOString().split("T")[0];
                    }

                } else if (service_type === 'ต่ออายุ') {
                    // if (document.getElementById('check_status').value === 'ยังไม่ถึงกำหนดการ') {
                    //     alert('ยังไม่ถึงกำหนดการต่ออายุ')

                    //} else if (document.getElementById('check_status').value === 'หมดอายุ') {
                        //alert('บัตรหมดอายุ กรุณาสมัครบัตรใหม่')

                    // } 
                    if ((document.getElementById('check_status').value === 'ต่ออายุ') && (document.getElementById('check_status').value === 'หมดอายุ')) {
                        getStatus()
                        getData(station)
                        
                        document.getElementById('copy_id_card').removeAttribute('required')
                        document.getElementById('copy_doc_car1').removeAttribute('required')
                        //document.getElementById('status-select2').disabled = true;
                        //document.getElementById('payment_name3').disabled = true;
                        document.getElementById('deposit').value = 0
                        document.getElementById('deposit').placeholder = 0
                        document.getElementById('price').value = data2.price
                        document.getElementById('price').placeholder = data2.price
                        document.getElementById('vcard_type').innerHTML = '<option value="' + data2.vcard_type + '">' + data2.vcard_type + '</option>'
                        document.getElementById('line_name').value = data2.line_name
                        if (document.getElementById('vcard_type').value === 'TAFF') {
                            document.getElementById('inputmonths').max = 12
                            document.getElementById('inputmonths').min = 0
                        } else {
                            document.getElementById('inputmonths').max = 1
                            document.getElementById('inputmonths').min = 0
                        }
                            //document.getElementById('inputdate').min = new Date(document.getElementById('exp_date').value).toISOString().split("T")[0];
                            //document.getElementById('inputdate').max = new Date(document.getElementById('exp_date').value).toISOString().split("T")[0];
                    } else {
                        getStatus()
                        getData(station)
                        
                        document.getElementById('copy_id_card').removeAttribute('required')
                        document.getElementById('copy_doc_car1').removeAttribute('required')
                        //document.getElementById('status-select2').disabled = true;
                        //document.getElementById('payment_name3').disabled = true;
                        document.getElementById('deposit').value = 0
                        document.getElementById('deposit').placeholder = 0
                        document.getElementById('price').value = data2.price
                        document.getElementById('price').placeholder = data2.price
                        document.getElementById('vcard_type').innerHTML = '<option value="' + data2.vcard_type + '">' + data2.vcard_type + '</option>'
                        document.getElementById('line_name').value = data2.line_name
                        if (document.getElementById('vcard_type').value === 'TAFF') {
                            document.getElementById('inputmonths').max = 12
                            document.getElementById('inputmonths').min = 0
                        } else {
                            document.getElementById('inputmonths').max = 1
                            document.getElementById('inputmonths').min = 0
                        }
                        if (document.getElementById('line_name').value === 'สายสีม่วง') {
                            //document.getElementById('inputdate').max = new Date().toISOString().split("T")[0];
                            //document.getElementById('inputdate').min = new Date().toISOString().split("T")[0];
                        } else {
                            //document.getElementById('inputdate').min = new Date().toISOString().split("T")[0];
                            //document.getElementById('inputdate').max = new Date(new Date().setDate(new Date().getDate() + 7)).toISOString().split("T")[0];
                        }
                    }
                } else if (service_type === 'ยกเลิก') {
                    getData(station)
                    getStatus()
                    //document.getElementById('status-select2').disabled = true;
                    //document.getElementById('payment_name3').disabled = true;
                    document.getElementById('address_type').disabled = true
                    document.getElementById('address_type2').disabled = true
                    document.getElementById('deposit_return').hidden = false
                    document.getElementById('return_card_2').setAttribute('required',true)
                    //document.getElementById('card_last_read_date').required = false
                    document.getElementById('deposit').value = 0
                    document.getElementById('deposit').placeholder = 0
                    document.getElementById('price').value = data2.price
                    document.getElementById('price').placeholder = data2.price
                    document.getElementById('inputmonths').removeAttribute('required')
                    document.getElementById('inputdate').removeAttribute('required')
                    document.getElementById('copy_id_card').removeAttribute('required')
                    document.getElementById('copy_doc_car1').removeAttribute('required')
                    document.getElementById('vcard_type').innerHTML = '<option value="' + data2.vcard_type + '">' + data2.vcard_type + '</option>'
                    document.getElementById('line_name').value = data2.line_name
                    if (document.getElementById('vcard_type').value === 'TAFF') {
                        document.getElementById('inputmonths').max = 12
                        document.getElementById('inputmonths').min = 0
                    } else {
                        document.getElementById('inputmonths').max = 1
                        document.getElementById('inputmonths').min = 0
                    }
                    if (document.getElementById('line_name').value === 'สายสีม่วง') {
                        //document.getElementById('inputdate').max = new Date().toISOString().split("T")[0];
                        //document.getElementById('inputdate').min = new Date().toISOString().split("T")[0];
                    } else {
                        //document.getElementById('inputdate').min = new Date().toISOString().split("T")[0];
                        //document.getElementById('inputdate').max = new Date(new Date().setDate(new Date().getDate() + 7)).toISOString().split("T")[0];
                    }
                } else if (service_type === 'บัตรหาย'){
                    await getData(station)
                    if(data2.deposit !== 0){
                        document.getElementById('deposit_address_type').hidden = false
                        document.getElementById('address_type_deposit').setAttribute('required',true)
                        document.getElementById('address_type_deposit').setAttribute('required',true)
                    }else{
                        document.getElementById('deposit_address_type').hidden = true
                        document.getElementById('address_type_deposit').removeAttribute('required')
                        document.getElementById('address_type_deposit').removeAttribute('required')
                    }
                    document.getElementById('copy_id_card').removeAttribute('required')
                    document.getElementById('copy_doc_car1').removeAttribute('required')
                    document.getElementById('price').value = 0
                    document.getElementById('vcard_type').innerHTML = '<option value="' + data2.vcard_type + '">' + data2.vcard_type + '</option>'
                    document.getElementById('line_name').value = data2.line_name
                    document.getElementById('inputdate').value = document.getElementById('log_service_start').value
                    document.getElementById('inputdate').readOnly = true 
                    document.getElementById('deposit').value = data2.deposit
                    document.getElementById('inputmonths').value = document.getElementById('log_month').value
                    document.getElementById('inputmonths').dispatchEvent(new Event('change'))
                    document.getElementById('inputmonths').readOnly = true
                    if (document.getElementById('vcard_type').value === 'TAFF') {
                        document.getElementById('inputmonths').max = 12
                        document.getElementById('inputmonths').min = 0
                    } else {
                        document.getElementById('inputmonths').max = 1
                        document.getElementById('inputmonths').min = 0
                    }
                }

            })
        })
        }else{
            alert('กรุณาใส่เลขบัตรหรือเลือกสถานีให้ถูกต้อง')
        }
        
    }
    //---------------------------------------------------------------------------------------------

    
    function check_dup(input) {
        const station =  document.getElementById('parking_station').value
        if (document.getElementById('service_type').value === 'สมัครใหม่') {
            fetch('checkdupcard/' + input.value+'/'+station).then(function (response) {
                response.json().then(function (datacheck) {
                    if (datacheck.status == 'dup') {
                        alert('รหัสบัตรนี้มีอยู่ในระบบแล้ว')
                        input.value = null
                    }
                })
            })
        }
    }

    $(window).on('load', customSelect())
    document.getElementById('reset').addEventListener('click', customSelect)
</script>

<script>
    document.getElementById('payment_name3').onchange = () =>{
        
        if(document.getElementById('payment_name3').value === '5'){
            document.getElementById('cheque1').hidden = false
            document.getElementById('cheque2').hidden = false
            document.getElementById('cheque_no').required = true
            document.getElementById('cheque_date').required = true
            document.getElementById('bank_name').required = true
            document.getElementById('bank_branch').required = true
        }else{
            document.getElementById('cheque1').hidden = true
            document.getElementById('cheque2').hidden = true
            document.getElementById('cheque_no').required = false
            document.getElementById('cheque_date').required = false
            document.getElementById('bank_name').required = false
            document.getElementById('bank_branch').required = false
        }
    }
    const service = document.getElementById('service_type')
    let identity_ = document.getElementById('identity_card')
    
    identity_.addEventListener('change',()=>{
        if (service.value === 'สมัครใหม่') {
            fetch('identity_id_/'+identity_.value).then((response)=>{
                response.json().then(async(data)=>{
                    
                    optionHTML2 = ''
                    for (brand of data.brand) {
                        optionHTML2 += '<option value="' + brand.brand + '">' + brand.brand + '</option>'
                    }
                    //user
                    //document.getElementById('cus_id').value = data.cus_id
                    document.getElementById('name').value = data.first_name
                    document.getElementById('lastname').value = data.last_name
                    document.getElementById('phone').value = data.phone
                    //address home
                    document.getElementById('unit_home').value = data.unit_home
                    document.getElementById('address_no').value = data.address_no
                    document.getElementById('village').value = data.village
                    document.getElementById('alley').value = data.alley
                    document.getElementById('street').value = data.street
                    document.getElementById('province').value = data.province
                    await fetch('district/' + data.province).then(async function(response){
                        await response.json().then(function(data){
                         optionHTML = '';
                         for (district of data.districtlist){
                          optionHTML += '<option value="' + district.name +'">' + district.name+ '</option>'
                         }
                         document.getElementById('district').innerHTML = optionHTML;
                        });
                       });
                    document.getElementById('district').value = data.district
                    await fetch('subdistrict/'+data.province+'/' + data.district).then(async function(response){
                        await response.json().then(function(data){
                         optionHTML = '';
                         for (sub of data.subdistrictlist){
                          optionHTML += '<option value="' + sub +'">' + sub + '</option>'
                         }
                         document.getElementById('sub_district').innerHTML = optionHTML;
                        });
                       });
                    document.getElementById('sub_district').value = data.sub_district
                    await fetch('postcode/'+data.province+'/' + data.district+'/' + data.sub_district).then(async function(response){
                        await response.json().then(function(data){
                         optionHTML = '';
                         for (post of data.postcodelist){
                          optionHTML += '<option value="' + post +'">' + post + '</option>'
                         }
                         document.getElementById('postal_code').innerHTML = optionHTML;
                        });
                       });
                    document.getElementById('postal_code').value = data.postal_code
                    // address company
                    document.getElementById('company_unit').value = data.company_unit
                    document.getElementById('company_name').value = data.company_name
                    document.getElementById('company_no').value = data.company_no
                    document.getElementById('company_village').value = data.company_village
                    document.getElementById('company_alley').value = data.company_alley
                    document.getElementById('company_street').value = data.company_street
                    document.getElementById('company_province').value = data.company_province
                    await fetch('district/' + data.company_province).then(async function(response){
                        await response.json().then(function(data){
                         optionHTML = '';
                         for (district of data.districtlist){
                          optionHTML += '<option value="' + district.name +'">' + district.name+ '</option>'
                         }
                         document.getElementById('company_district').innerHTML = optionHTML;
                        });
                       });
                    document.getElementById('company_district').value = data.company_district
                    await fetch('subdistrict/'+data.company_province+'/' + data.company_district).then(async function(response){
                        await response.json().then(function(data){
                         optionHTML = '';
                         for (sub of data.subdistrictlist){
                          optionHTML += '<option value="' + sub +'">' + sub + '</option>'
                         }
                         document.getElementById('company_sub_district').innerHTML = optionHTML;
                        });
                       });
                    document.getElementById('company_sub_district').value = data.company_sub_district
                    await fetch('postcode/'+data.company_province+'/' + data.company_district+'/' + data.company_sub_district).then(async function(response){
                        await response.json().then(function(data){
                         optionHTML = '';
                         for (post of data.postcodelist){
                          optionHTML += '<option value="' + post +'">' + post + '</option>'
                         }
                         document.getElementById('company_postal_code').innerHTML = optionHTML;
                        });
                       });
                    document.getElementById('company_postal_code').value = data.company_postal_code
    
                    //car1
                    document.getElementById('license_plate1').value = data.license_plate1
                    document.getElementById('province_car1').value = data.province_car1 
                    document.getElementById('color1').value = data.color1
                    document.getElementById('brand_name1').innerHTML = '<option value="' + data.brand_name1 + '">' + data.brand_name1 + '</option>' + optionHTML2
                    //car2
                    document.getElementById('license_plate2').value = data.license_plate2
                    document.getElementById('province_car2').value = data.province_car2 
                    document.getElementById('color2').value = data.color2
                    document.getElementById('brand_name2').innerHTML = '<option value="' + data.brand_name2 + '">' + data.brand_name2 + '</option>' + optionHTML2
    
                    
                
                })
            })
        }else{

        }
    })
</script>

<script>

    function re_count(park){
        console.log(park)
        $.ajax({
            url: '/count_InLine',
            type: 'POST',
            data: JSON.stringify(park),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                console.log(response)
                response = response.split(",")
                var total_today = document.getElementById('total_today')
                total_today.innerHTML= response[0]

                var count_new = document.getElementById('count_new')
                count_new.innerHTML= response[1]

                var count_old = document.getElementById('count_old')
                count_old.innerHTML= response[2]

                var total_month = document.getElementById('total_month')
                total_month.innerHTML= response[3]

                var count_q = document.getElementById('count_q')
                count_q.innerHTML= response[4]
              
            }
        });

    }
    //รายการผู้สมัครใหม่
    function tableNew_cus() {
      
        tableID = "customer-list1";
        filename = "รายการสมัครใหม่";
        var getLine = document.getElementById("line").value
        var getPark = document.getElementById("park").value

        if (getPark == "ทั้งหมด") {
            var Npark = document.getElementById("park")
            getPark = [];
            for (i = 0; i < Npark.length; i++) {
                if ((Npark.options[i]).value != "ทั้งหมด") {
                    getPark.push((Npark.options[i]).value)
                }

            }
        }
        if(getLine != 'ทั้งหมด'){
            re_count(getPark)
            console.log(getPark)
        }
       
        $.ajax({
            url: '/search_line',
            type: 'POST',
            data: JSON.stringify(getLine + "," + getPark),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                $("#customer-list1_show").html("");
                for (var i = 0; i < response.length; i++) {
                    var tr = "<tr>";
                    var td0 = "<td>" + (i + 1) + "</td>";
                    var td1 = "<td>" + response[i][0] + "</td>";
                    if (response[i][1] != null) {
                        var regis = convert_date(String(response[i][1]))
                        
                        var td2 = "<td>" + regis + "</td>";
                    }
                    else {
                        var td2 = "<td>" + response[i][1] + "</td>";
                    }
                    var td3 = "<td>" + response[i][2] + "</td>";
                    var td4 = "<td>" + response[i][3] + "</td>";
                    var td5 = "<td>" + response[i][4] + "</td>";
                    var td6 = "<td>" + response[i][5] + "</td>";
                    var td7 = "<td>" + response[i][6] + "</td>";
                    var td8 = "<td>" + response[i][7] + "</td>";
                    var deposit_amount = "<td>" + response[i][24] + "</td>";
                    var td9 = "<td>" + response[i][8] + "</td>";

                    if (response[i][9] != null) {

                        var td10 = "<td>" + "<button class='btn btn-info' data-toggle='modal' data-target='#showdocModal' data-img-id='" + response[i][9] + "' onclick='showcopyCard($(this))'>" + 'View Full Image' + '</button>' + "</td>"
                    }
                    else {
                        var td10 = "<td>" + "ไม่พบข้อมูล" + "</td>"
                    }

                    if (response[i][10] != null && response[i][20] != null) {
                        var td11 = "<td>" + "<button class='btn btn-info' data-toggle='modal' data-target='#showdocModalcar' data-img-id='" + response[i][10] +','+response[i][20]+"' onclick='showcopyCar($(this))'>" + 'View Full Image' + '</button>' + "</td>"
                    }
                    else if(response[i][10] != null && response[i][20] == null){
                        var td11 = "<td>" + "<button class='btn btn-info' data-toggle='modal' data-target='#showdocModalcar' data-img-id='" + response[i][10] +"' onclick='showcopyCar($(this))'>" + 'View Full Image' + '</button>' + "</td>"
                    }
                    else {
                        var td11 = "<td>" + "ไม่พบข้อมูล" + "</td>";
                    }
                    
                    
                    if (response[i][21] != null) {

                     var mrt_card = "<td>" + "<button class='btn btn-info'  data-toggle='modal' data-target='#showdocModalMRT' data-img-id='" + response[i][21] + "' onclick='showcopyMRT($(this))'>" + 'View Full Image' + '</button>' + "</td>"
                    }
                    else {
                     var mrt_card = "<td>" + "ไม่พบข้อมูล" + "</td>"
                    }


                    if (response[i][11] == '1') {
                        var verify_status = "ผ่านการตรวจสอบ"
                    } else if (response[i][11] == '2' || response[i][11] == "" || response[i][11] == null) {
                        var verify_status = "ไม่ผ่านการตรวจสอบ"
                    }
                    else if (response[i][11] == '3') {
                        var verify_status = "รอจองคิว"
                    }
                    else if (response[i][11] == '4') {
                        var verify_status = "จองคิว"
                    }
                    else if (response[i][11] == '5') {
                        var verify_status = "ยกเลิก"
                    }
                    else if (response[i][11] == '6') {
                        var verify_status = "<font color='#DAA520'>รอให้คิว</font>"
                    }
                    var td12 = "<td>" + verify_status + "</td>";// verify_status
                    var td13 = "<td>" + response[i][12] + "</td>";
                    var td14 = "<td>" + response[i][13] + "</td>";
                    if (response[i][14] == '1') {
                        var paymentName = "เงินสด"
                    }
                    else if (response[i][14] == '2') {
                        var paymentName = "บัตรเครดิต"
                    }
                    else if (response[i][14] == '3') {
                        var paymentName = "QR Code"
                    }
                    else if (response[i][14] == '4') {
                        var paymentName = "ผูกบัญชี"
                    }
                    else if (response[i][9] == '5') { //aof 21-09-64
                        var paymentName = "เช็ค"      
                    } else {
                        var paymentName = "ยังไม่ได้ระบุช่องทางการชำระ"

                    }
                    var td15 = "<td>" + paymentName + "</td>";   // payment_name
                    if (response[i][15] == '1') {
                        var payStatus = "ชำระแล้ว"
                    }
                    else {
                        var payStatus = "ยังไม่ได้ชำระ"
                    }
                    var td16 = "<td>" + payStatus + "</td>";//payment_status

                    var id = response[i][16]

                    if (response[i][17] != null) {
                        var paydate = convert_date(String(response[i][17]))
                        var td17 = "<td>" + paydate + "</td>";
                    }
                    else {
                        var paydate = ''
                        var td17 = "<td>" + response[i][17] + "</td>";
                    }
                    if (response[i][18] != null) {
                        var c = convert_date(String(response[i][18]))
                        var td18 = "<td>" + c + "</td>";
                    }
                    else {
                        var c = ''
                        var td18 = "<td>" + response[i][18] + "</td>";
                    }
                    var data = id + "," + verify_status + "," + paymentName + "," + payStatus+","+paydate+","+c
                    if(response[i][19]!= null){
                        var payRef_ktb = response[i][19]
                        var td_void = '<td class="textbox"><button class="btn btn-warning" data-toggle="modal" '+ 'data-tran-id="'+payRef_ktb+'" onclick="void_confirm($(this))" id="voidEvent" data-target="#voidModal"> Void</button></td>'
                        if(payStatus=='ชำระแล้ว'&& (new Date(response[i][1]) > new Date('2021-09-15'))){
                         var td19 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit" data-tran-id="' + data + '"onclick="ajax($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_new($(this))"><i class="fas fa-print"></i> Print</button></td>'
                       
                        }
                        else{
                            var td19 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit" data-tran-id="' + data + '"onclick="ajax($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_new($(this))" disabled><i class="fas fa-print" ></i> Print</button></td>'   
                        }
                    }
                    else{
                        var td_void = '<td class="textbox"><button class="btn btn-warning" data-toggle="modal"  disabled> Void</button></td>'
                        if(payStatus=='ชำระแล้ว' && (new Date(response[i][1]) > new Date('2021-09-15'))){
                        var td19 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit" data-tran-id="' + data + '"onclick="ajax($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_new($(this))"><i class="fas fa-print"></i> Print</button></td>'
                        }
                        else{
                            var td19 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit" data-tran-id="' + data + '"onclick="ajax($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_new($(this))" disabled><i class="fas fa-print"></i> Print</button></td>'
                        }
                    }

                    if (response[i][25] == '1'){
                        var input_type = 'app'
                    }else {
                        var input_type = 'contact site'
                    }
                    var td30 = "<td>" + input_type + "</td>";

                    if(response[i][22]!=null){
                       var servicedate =  convert_date(String(response[i][22]))
                       servicedate = "<td>" + servicedate + "</td>";
                    }
                    else{
                        var servicedate = "<td>" + response[i][22] + "</td>";
                    }
                    if(response[i][23]!= null){
                        var expidate = convert_date(String(response[i][23]))
                        expidate = "<td>" + expidate + "</td>";
                    }
                    else{
                        var  expidate = "<td>" + response[i][23] + "</td>";
                    }
                   
                    var td20 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit_no-receipt" onclick="reCeipt($(this))" data-tran-id="' + id + '"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit_inv" data-tran-id="' + id + '"onclick="addr_type($(this))"> <i class="fas fa-edit"></i> แก้ไข(ที่อยู่ใบกำกับ)</button></td>' 
                    $("#customer-list1").append(tr + td0 + td1 + td2 + td3 + td4 + td5 + td6 + td8 + deposit_amount+ td9 + td10 + td11 +mrt_card+ td12 + td13 + td14 + td15 + td30 + td16 + td17 + servicedate+expidate+ td18 + td19 + td20+td_void)

                }
            }

        });
    }
    function addr_type(btn){
        const id = btn.attr('data-tran-id')
        document.getElementById('addr_id').value = id
    }
    function addr_type2(btn){
        const id = btn.attr('data-tran-id')
        document.getElementById('addr_id2').value = id
    }
    function update_addr(){
        const id = document.getElementById('addr_id').value
        const address_type = document.getElementById('address_type_2').value 
        const deposit_address_type = document.getElementById('deposit_address_type_2').value
        console.log(id)
        console.log(address_type)
        console.log(deposit_address_type)
        $.ajax({
            url:'/manage/update_address_type',
            data:{id:id,address_type:address_type,deposit_address_type:deposit_address_type},
            type:'POST',
            success:function(data){
                document.getElementById('address_type_2').value  = null
                document.getElementById('deposit_address_type_2').value = null
                alert('บันทึกข้อมูลเรียบร้อย')
        }
    })
    }
    function update_addr2(){
        const id = document.getElementById('addr_id2').value
        const address_type = document.getElementById('address_type_3').value 
        const deposit_address_type = document.getElementById('deposit_address_type_3').value
        console.log(id)
        console.log(address_type)
        console.log(deposit_address_type)
        $.ajax({
            url:'/manage/update_address_type',
            data:{id:id,address_type:address_type,deposit_address_type:deposit_address_type},
            type:'POST',
            success:function(data){
                document.getElementById('address_type_3').value  = null
                document.getElementById('deposit_address_type_3').value = null
                alert('บันทึกข้อมูลเรียบร้อย')
        }
    })
    }
    function reCeipt(btn){
        const id =  btn.attr("data-tran-id");
        document.getElementById('receiptid').value = id
        console.log(id)
    }
    function updateReceipt(){
        const id = document.getElementById('receiptid').value
        const receipt = document.getElementById('receipt_no').value
        if (receipt === ''){
            const receipt = document.getElementById('receipt_no2').value
            if (receipt !== ''){
                console.log('no2')
                $.ajax({
                    url:'/manage/update_receiptno',
                    data:{id:id,receipt:receipt},
                    type:'POST',
                    success:function(data){
                        document.getElementById('receiptid').value = null
                        document.getElementById('receipt_no2').value = null
                        alert('บันทึกข้อมูลเรียบร้อย')
                    }
                })
            }
            else{
                console.log('no3')
                const receipt = document.getElementById('receipt_no3').value
                $.ajax({
                url:'/manage/update_receiptno',
                data:{id:id,receipt:receipt},
                type:'POST',
                success:function(data){
                    document.getElementById('receiptid').value = null
                    document.getElementById('receipt_no3').value = null
                    alert('บันทึกข้อมูลเรียบร้อย')
                }
            })
            }
        }else{
            console.log(id)
            console.log(receipt)
            $.ajax({
                url:'/manage/update_receiptno',
                data:{id:id,receipt:receipt},
                type:'POST',
                success:function(data){
                    document.getElementById('receiptid').value = null
                    document.getElementById('receipt_no').value = null
                    alert('บันทึกข้อมูลเรียบร้อย')
                }
            })
        }
        
    }
    function testid_new($this){
        var id =  $this.attr("data-tran-id");
        console.log(id)
        window.open('/manage/tax-invoice/' + id,'_blank')
    }
    function update_newCus(){  
        var obj = new Object();
            obj.id = $("#id").val()
            obj.verify_status  = $("#verify_").val()
            obj.payment_name = $("#payment_name").val()
            obj.payment_status = $("#payment_status1").val()
            obj.payment_date = $("#payment_date1").val()
            obj.card_last_read_date = $("#card_last_read_date1").val()
            obj.comment_verify = $("#comment_verify").val()
        var jsonString= JSON.stringify(obj);

        const requestOptions = {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                data: jsonString,
            })
        }
        fetch('/check-member-remainning', requestOptions)
        .then(res=>res.json())
        .then(data=>{
            if(data.status == true){
                $.ajax({
                    url: '/update_newCus',
                    data: jsonString,
                    contentType: "application/json; charset=utf-8",
                    type: 'POST',
                    success: function (res) {
                        alert("บันทึกข้อมูลเรียบร้อย");
                        tableNew_cus()
                    }
                });
            }else{
                alert("จำนวนที่จอดว่างของลานจอดไม่เพียงพอ ไม่สามารถให้ผ่านการตรวจสอบได้ กรุณาเลือกสถานะการจองคิว");
            }
        })   
        // $.ajax({
        // url: '/update_newCus',
        // data: jsonString,
        // contentType: "application/json; charset=utf-8",
        // type: 'POST',
        // success: function(data){
        //      alert("บันทึกข้อมูลเรียบร้อย");
        //      tableNew_cus()

        // }   
        // });
    }
    var log_verify;
    var log_payst;
    var log_payname;

    function showcopyMRT($this){
        var img = $this.attr("data-img-id");
        src = "../static/image-manage/document/" + img
        img = document.getElementById("img4");
        img.src = src
    }

    function showcopyCar($this) {
        var img = $this.attr("data-img-id");
        img = img.split(',')
        src1 = "../static/image-manage/document/" + img[0]
        var img1 = document.getElementById("img2");
        img1.src = src1
        if(img[1]!=''){
            src2 = "../static/image-manage/document/" + img[1]
            var img2 = document.getElementById("img3");
            img2.src = src2
            document.getElementById("leftclick").style.display = "inline";
            document.getElementById("rightclick").style.display = "inline";
        }
        else{
            document.getElementById("leftclick").style.display = "none";
            document.getElementById("rightclick").style.display = "none";
            document.getElementById("img3").style.display = "none";
        }
    }
    function showcopyCard($this) {
        var img = $this.attr("data-img-id");
        src = "../static/image-manage/document/" + img
        var img = document.getElementById("img1");
        console.log(src)
        img.src = src
    }

    var checkNull = 0 ;
    function ajax($this) {
        var id = $this.attr("data-tran-id");
        console.log(id,'click edit')
        var sp = id.split(",");
        $('input[name="id"]').val(sp[0]);
        $('input[name="verify_status"]').val(sp[1]);
        $('input[name="payment_name"]').val(sp[2]);
        $('input[name="payment_status1"]').val(sp[3]);
        log_verify = sp[1];
        log_payname = sp[2];
        log_payst = sp[3];
        var payDate = sp[4]
        var readDate = sp[5]
      
        split_r = readDate.split('/')
        card_read_date = split_r[1]+'-'+split_r[0]+'-'+split_r[2]
        card_read_date = new Date(card_read_date)
        month_last_read = card_read_date.getMonth()
        now = new Date().getMonth()

        if(log_payst == 'ชำระแล้ว'){
          document.getElementById('payment_name').readOnly = true;
          document.getElementById('payment_status1').readOnly = true;
        }
        else{
         document.getElementById('payment_name').readOnly = false;
        }
        if(payDate ==''){
            checkNull = 1
            document.getElementById('payment_date1').readOnly = false;
            document.getElementById('payment_date1').setAttribute("type", "datetime-local");
        }
        else{
            checkNull = 0
            document.getElementById('payment_date1').setAttribute("type", "text");
            document.getElementById('payment_date1').value = payDate;
            document.getElementById('payment_date1').readOnly = true;
        }
        if(readDate =='' || month_last_read != now ){
            document.getElementById('card_last_read_date1').setAttribute("type", "date");
        }
        else{
            document.getElementById('card_last_read_date1').setAttribute("type", "text");
            document.getElementById('card_last_read_date1').value = readDate;
        }
        if( month_last_read == now ){
            document.getElementById('card_last_read_date1').readOnly = true;
        }
        else{
            document.getElementById('card_last_read_date1').readOnly = false;
        }
        if(log_payname!='เงินสด'){
            document.getElementById('payment_status1').readOnly = false;
            document.getElementById('payment_date1').readOnly = false;
            
        }
        else{
            if(payDate == ''){
            document.getElementById('payment_status1').readOnly = false;
            document.getElementById('payment_date1').readOnly = false;
            }
        }
  
     
    }
    $('#verify_').on('click', function () {
        $(this).val('');
    });
    $('#verify_').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_verify);
        }
    });
    $('#payment_name').on('click', function () {
        $(this).val('');
    });
    $('#payment_name').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_payname);
         
        }
    });
    $('#payment_status1').on('click', function () {
        $(this).val('');
    });
    $('#payment_status1').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_payst);
        }
    });

    //รายการต่ออายุ
    function tableOld_cus() {
        reset_tr()
        tableID = "customer-list_2";
        filename = "รายการต่ออายุ";
        var getLine = document.getElementById("line").value
        var getPark = document.getElementById("park").value
        if (getPark == "ทั้งหมด") {
            var Npark = document.getElementById("park")
            getPark = [];
            for (i = 0; i < Npark.length; i++) {
                if ((Npark.options[i]).value != "ทั้งหมด") {
                    getPark.push((Npark.options[i]).value)
                }

            }
        }
        $.ajax({
            url: '/tableOld_cus',
            type: 'POST',
            data: JSON.stringify(getLine + "," + getPark),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                $("#customer-list_2_show").html("");
                console.log(response.length)
                for (var i = 0; i < response.length; i++) {
                    var tr = "<tr>";
                    var td0 = "<td>" + (i + 1) + "</td>"; //id
                    var td1 = "<td>" + response[i][0] + "</td>"; //card id
                    if (response[i][1] != null) { //approve date
                        var regis = convert_date(String(response[i][1]))
                        var td2 = "<td>" + regis + "</td>";
                    }
                    else {
                        var td2 = "<td>" + response[i][1] + "</td>";
                    }
                    var td3 = "<td>" + response[i][2] + "</td>";
                    var td4 = "<td>" + response[i][3] + "</td>";
                    var td5 = "<td>" + response[i][4] + "</td>";
                    var td6 = "<td>" + response[i][5] + "</td>";
                    var td7 = "<td>" + response[i][6] + "</td>";
                    var td8 = "<td>" + response[i][7] + "</td>";
                    var td9 = "<td>" + response[i][8] + "</td>";
                    if (response[i][9] == '1') {
                        var paymentName = "เงินสด"
                    }
                    else if (response[i][9] == '2') {
                        var paymentName = "บัตรเครดิต/เดบิต"
                    }
                    else if (response[i][9] == '3') {
                        var paymentName = "QR Code"
                    }
                    else if (response[i][9] == '4') {
                        var paymentName = "ผูกบัญชี"
                    }
                    else if (response[i][9] == '5') { //aof 21-09-64
                        var paymentName = "เช็ค"    
                    } else {
                        var paymentName = "ยังไม่ได้ระบุช่องทางการชำระ"
                    }
                    var td10 = "<td>" + paymentName + "</td>";
                    console.log(response[i][17])
                    if (response[i][17] == '1'){
                        var input_type = 'app'
                    }else {
                        var input_type = 'contact site'
                    }
                    var td30 = "<td>" + input_type + "</td>";
                    
                    if (response[i][10] == '1') {
                        var payStatus = "ชำระแล้ว"
                    }
                    else {
                        var payStatus = "ยังไม่ได้ชำระ"
                    }
                    var td11 = "<td>" + payStatus + "</td>";
                    var id = response[i][11]
                    if(response[i][12]!= null){
                     var d = convert_date(String(response[i][12]))
                     var td12 = "<td>" + d + "</td>";
                    }
                    else{
                        var d = ''
                        var td12 = "<td>" + response[i][12] + "</td>";
                    }  
                    if (response[i][13] != null) {
                        var start = convert_date(String(response[i][13]))
                        var td13 = "<td>" + start + "</td>";
                    }
                    else{
                        var td13 = "<td>" + response[i][13] + "</td>";
                    }
                    if (response[i][14] != null) {
                        var read = convert_date(String(response[i][14]))
                        var td14 = "<td>" + read + "</td>";
                    }
                    else {
                        var read = ''
                        var td14 = "<td>" + response[i][14] + "</td>";

                    }
                    var data = id + "," + paymentName + "," + payStatus + "," + d + ","+read
                    if(response[i][15]!=null){
                        var payRef_ktb = response[i][15]
                        var td_void =  '<td class="textbox"><button class="btn btn-warning" data-toggle="modal" '+ 'data-tran-id="'+payRef_ktb+'" onclick="void_confirm($(this))" id="voidEvent"  data-target="#voidModal"> Void</button></td>'
                        if(payStatus=='ชำระแล้ว' && (new Date(response[i][1]) <= new Date('2021-09-16'))){
                        console.log('print1',response[i][0])
                        var td15 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit2" data-tran-id="' + data + '"onclick="ajaxOldcus($(this))"> <i class="fas fa-edit"></i> แก้ไข</button></td>'
                        }
                        else{
                            console.log('print2',response[i][0])
                            var td15 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit2" data-tran-id="' + data + '"onclick="ajaxOldcus($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_old($(this))" ><i class="fas fa-print"></i> Print</button></td>'  
                        }
                    }
                    else{
                        var td_void = '<td class="textbox"><button class="btn btn-warning" data-toggle="modal" disabled> Void</button></td>'
                        if(payStatus=='ชำระแล้ว'  && (new Date(response[i][1]) >= new Date('2021-09-16'))){
                            console.log('print3',response[i][0])
                        var td15 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit2" data-tran-id="' + data + '"onclick="ajaxOldcus($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_old($(this))"><i class="fas fa-print"></i> Print</button></td>'
                        }
                        else{
                            console.log('print4',response[i][0])
                            var td15 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit2" data-tran-id="' + data + '"onclick="ajaxOldcus($(this))"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' +id+'"onclick="testid_old($(this))" disabled><i class="fas fa-print"></i> Print</button></td>'
                        }
                    }
                    if(response[i][16]!= null){
                        var expidate = convert_date(String(response[i][16]))
                        expidate = "<td>" + expidate + "</td>";
                    }
                    else{
                        var  expidate = "<td>" + response[i][23] + "</td>";
                    }
                  
                    var td16 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" onclick="reCeipt($(this))" data-target="#Modaledit_no-receipt2" data-tran-id="' + id + '"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit_inv2" data-tran-id="' + id + '"onclick="addr_type2($(this))"> <i class="fas fa-edit"></i> แก้ไข(ที่อยู่ใบกำกับ)</button></td>' 
                    $("#customer-list_2").append(tr + td0 + td1 + td2 + td3 + td4 + td5 + td6  + td8 + td9 + td10 + td30 + td11 + td12 + td13 +expidate+ td14 + td15 + td16+td_void);

                }
            }
        });
    }
    function testid_old($this){
        var id =  $this.attr("data-tran-id");
        console.log(id)
        window.open('/manage/tax-invoice/' + id,'_blank')
    }
    function update_oldCus(){
        var obj = new Object();
            obj.id = $("#id2").val()
            obj.verify_status  = $("#verify_2").val()
            obj.payment_name = $("#payment_name2").val()
            obj.payment_status = $("#payment_status2").val()
            obj.payment_date = $("#payment_date2").val()
            obj.card_last_read_date = $("#card_last_read_date2").val()
        var jsonString= JSON.stringify(obj);     
        $.ajax({
        url: '/update_oldcus',
        data: jsonString,
        contentType: "application/json; charset=utf-8",
        type: 'POST',
        success: function(data){
             alert("บันทึกข้อมูลเรียบร้อย");
             tableOld_cus()

        }   
        });
     }

    function ajaxOldcus($this) {
        var id = $this.attr("data-tran-id");
        console.log(id,'id')
        var sp = id.split(",");
        $('input[name="id2"]').val(sp[0]);
        $('input[name="payment_name2"]').val(sp[1]);
        $('input[name="payment_status2"]').val(sp[2]);
        var payDate = sp[3]
        var readDate = sp[4]
        var change = true
        split_r = readDate.split('/')
        card_read_date = split_r[1]+'-'+split_r[0]+'-'+split_r[2]
        card_read_date = new Date(card_read_date)
        month_last_read = card_read_date.getMonth()
        now = new Date().getMonth()

        if(sp[2] == 'ชำระแล้ว'){
          document.getElementById('payment_name2').readOnly = true;
          document.getElementById('payment_status2').readOnly = true;
        }
        else{
         document.getElementById('payment_name2').readOnly = false;
        }
        if(payDate ==''){
            document.getElementById('payment_date2').setAttribute("type", "datetime-local");
        }
        else{
            document.getElementById('payment_date2').setAttribute("type", "text");
            document.getElementById('payment_date2').value = payDate;
        }
        if(change === true ){
            document.getElementById('card_last_read_date2').setAttribute("type", "date");
        }
        else{
            document.getElementById('card_last_read_date2').setAttribute("type", "text");
            document.getElementById('card_last_read_date2').value = readDate;
        }
        if( month_last_read == now ){
            document.getElementById('card_last_read_date2').readOnly = false;
        }
        else{
            document.getElementById('card_last_read_date2').readOnly = false;
        }
        log_payname = sp[1];
        log_payst = sp[2];
        if(log_payname!='เงินสด'){
            //document.getElementById('payment_status2').readOnly = true;
            document.getElementById('payment_date2').readOnly = false;
        }
        else{
            document.getElementById('payment_status2').readOnly = false;
            document.getElementById('payment_date2').readOnly = false;
        }
  
    }
    $('#payment_name2').on('click', function () {
        $(this).val('');
    });
    $('#payment_name2').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_payname);
        }
    });
    $('#payment_status2').on('click', function () {
        $(this).val('');
    });

    $('#payment_status2').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_payst);
        }
    });


    //ยกเลิกสมาชิก
    function tableCancle_cus() {
        reset_tr()
        tableID = "customer-list_3";
        filename = "รายการยกเลิกสมาชิก";
        var getLine = document.getElementById("line").value
        var getPark = document.getElementById("park").value
        if (getPark == "ทั้งหมด") {
            var Npark = document.getElementById("park")
            getPark = [];
            for (i = 0; i < Npark.length; i++) {
                if ((Npark.options[i]).value != "ทั้งหมด") {
                    getPark.push((Npark.options[i]).value)
                }

            }
        }

        $.ajax({
            url: '/tableCancle_cus',
            type: 'POST',
            data: JSON.stringify(getLine + "," + getPark),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                console.log(response)
                $("#customer-list_3_show").html("");
                for (var i = 0; i < response.length; i++) {
                    var tr = "<tr>";
                    var td0 = "<td>" + (i + 1) + "</td>";
                    var td1 = "<td>" + response[i][0] + "</td>";
                    if (response[i][1] != null) {
                        var regis = convert_date(String(response[i][1]))
                        var td2 = "<td>" + regis + "</td>";
                    }
                    else {
                        var td2 = "<td>" + response[i][1] + "</td>";

                    }
                    if (response[i][2] != null) {
                        var expi = convert_date(String(response[i][2]))
                        var td3 = "<td>" + expi + "</td>";
                    }
                    else {
                        var td3 = "<td>" + response[i][2] + "</ td>";

                    }
                    var td4 = "<td>" + response[i][3] + "</td>";
                    var td5 = "<td>" + response[i][4] + "</td>";
                    var td6 = "<td>" + response[i][5] + "</td>";
                    var td7 = "<td>" + response[i][6] + "</td>";
                    var td8 = "<td>" + response[i][7] + "</td>";
                    var td9 = "<td>" + response[i][8] + "</td>";
                    if (response[i][9] == '1') {
                        deposit_status = "คืนแล้ว";
                    }
                    else {
                        deposit_status = "";
                    }
                    var td10 = "<td>" + deposit_status + "</td>";
                    if (response[i][10] == '1') {
                        return_status = "คืนบัตรแล้ว";
                    }
                    else {
                        return_status = "";
                    }

                    if (response[i][13] == '1'){
                        var input_type = 'app'
                    }else {
                        var input_type = 'contact site'
                    }
                    var td30 = "<td>" + input_type + "</td>";
                    
                    var td11 = "<td>" + return_status + "</td>";
                    var td12 = "<td>" + response[i][11] + "</td>";
                    var id = response[i][12]
                    var data = id + "," + deposit_status + "," + return_status
                    var td13 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit3" data-tran-id="' + data + '"onclick="ajaxCancle_cus($(this))"> <i class="fas fa-edit"></i> แก้ไข</button></td>'
                    $("#customer-list_3").append(tr + td0 + td1 + td2 + td3 + td4 + td5 + td6 + td7  + td9 + td10 + td30 + td11  + td12 + td13 );

                }
            }
        });
    }
 
    function update_cancleCus(){
        var obj = new Object();
            obj.id = $("#id3").val()
            obj.depositStatus  = $("#depositStatus").val()
            obj.return_card = $("#return_card1").val()
            obj.comment = $("#comment1").val()
           
        var jsonString= JSON.stringify(obj);     
        $.ajax({
        url: '/update_cancleCus',
        data: jsonString,
        contentType: "application/json; charset=utf-8",
        type: 'POST',
        success: function(data){
             alert("บันทึกข้อมูลเรียบร้อย");
             tableCancle_cus()

        }   
        });
     }


    var log_Status, log_return;
    function ajaxCancle_cus($this) {
        var id = $this.attr("data-tran-id");
        var sp = id.split(",");
        $('input[name="id3"]').val(sp[0]);
        $('input[name="depositStatus"]').val(sp[1]);
        $('input[name="return_card"]').val(sp[2]);
        log_Status = sp[1];
        log_return = sp[2];

    }
    $('#depositStatus').on('click', function () {
        $(this).val('');
    });
    $('#depositStatus').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_Status);
        }
    });
    $('#return_card').on('click', function () {
        $(this).val('');
    });
    $('#return_card').on('mouseleave', function () {
        if ($(this).val() == '') {
            $(this).val(log_return);
        }
    });

    //รายการบัตรหมดอายุ
    function table_expire() {
        reset_tr()
        tableID = "customer-list_4";
        filename = "รายการบัตรหมดอายุ";
        var getLine = document.getElementById("line").value
        var getPark = document.getElementById("park").value
        if (getPark == "ทั้งหมด") {
            var Npark = document.getElementById("park")
            getPark = [];
            for (i = 0; i < Npark.length; i++) {
                if ((Npark.options[i]).value != "ทั้งหมด") {
                    getPark.push((Npark.options[i]).value)
                }

            }
        }
        $.ajax({
            url: '/tableExpire_cus',
            type: 'POST',
            data: JSON.stringify(getLine + "," + getPark),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                console.log(response)
                $("#customer-list_4_show").html("");
                for (var i = 0; i < response.length; i++) {
                    var tr = "<tr>";
                    var td0 = "<td>" + (i + 1) + "</td>";
                    var td1 = "<td>" + response[i][0] + "</td>";
                    if(response[i][1]!=null){
                     var regis = convert_date(String(response[i][1]))
                     var td2 = "<td>" + regis + "</td>";
                    }
                    else{
                        var td2 = "<td>" + response[i][1] + "</td>";
                    }
                    var td3 = "<td>" + response[i][2] + "</td>";
                    var td4 = "<td>" + response[i][3] + "</td>";
                    var td5 = "<td>" + response[i][4] + "</td>";
                    var td6 = "<td>" + response[i][5] + "</td>";
                    if(response[i][6]!=null){
                     var readcard = convert_date(String(response[i][6]))
                     var td7 = "<td>" + readcard + "</td>";

                    }
                    else{
                        var td7 = "<td>" + response[i][6] + "</td>";

                    }
                    
                    var expi = convert_date(String(response[i][7]))
                    var td8 = "<td>" + expi + "</td>";
                    var date =  String(response[i][7]).split(",")
                    date = date[1].substring(1, 13)
                    enddate = new Date(date)
                    getdate = enddate.getDate();
                    var end = getdate + 7;
                    enddate.setDate(end)
                    formatted_date = enddate.getDate() + "/" + (enddate.getMonth() + 1) + "/" + enddate.getFullYear()
                    var td9 = "<td>" + formatted_date + "</td>";
                    $("#customer-list_4").append(tr + td0 + td1 + td2 + td3 + td4 + td5 + td6 + td7 + td8 + td9);

                }
            }
        });
    }


    function convert_date(date) {
        console.log(date)
        date = date.split(",")
        date = date[1].substring(1, 13)
        enddate = new Date(date)
        formatted_date = enddate.getDate() + "/" + (enddate.getMonth() + 1) + "/" + enddate.getFullYear() 
        return formatted_date
    }
    //รายการรอดำเนินการ
    function table_pending() {
        reset_tr()
        tableID = "customer-list_5";
        filename = "รายการบัตรรอดำเนินการ";
        var getLine = document.getElementById("line").value
        var getPark = document.getElementById("park").value
        if (getPark == "ทั้งหมด") {
            var Npark = document.getElementById("park")
            getPark = [];
            for (i = 0; i < Npark.length; i++) {
                if ((Npark.options[i]).value != "ทั้งหมด") {
                    getPark.push((Npark.options[i]).value)
                }

            }
        }

        $.ajax({
            url: '/tablePending_cus',
            type: 'POST',
            data: JSON.stringify(getLine + "," + getPark),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                $("#customer-list_5_show").html("");
                for (var i = 0; i < response.length; i++) {
                    var tr = "<tr>";
                    var td0 = "<td>" + (i + 1) + "</td>";
                    var td1 = "<td>" + response[i][0] + "</td>";
                    if (response[i][1] != null) {
                        var regis = convert_date(String(response[i][1]))
                        var td2 = "<td>" + regis + "</td>";
                    }
                    else {
                        var td2 = "<td>" + response[i][1] + "</td>";

                    }
                    var td3 = "<td>" + response[i][2] + "</td>";
                    var td4 = "<td>" + response[i][3] + "</td>";
                    var td5 = "<td>" + response[i][4] + "</td>";
                    var td6 = "<td>" + response[i][5] + "</td>";
                    if (response[i][6] != null) {
                        var pay = convert_date(String(response[i][6]))
                        var td7 = "<td>" + pay + "</td>";
                    }
                    else {
                        var td7 = "<td>" + response[i][6] + "</td>";
                    }
                    if (response[i][7] != null) {
                        var c = convert_date(String(response[i][7]))
                        var td8 = "<td>" + c + "</td>";
                    }
                    else {
                        var td8 = "<td>" + response[i][7] + "</td>";
                    }
                    if (response[i][8] != null) {
                        var c = convert_date(String(response[i][8]))
                        var td9 = "<td>" + c + "</td>";
                    }
                    else {
                        var td9 = "<td>" + response[i][8] + "</td>";
                    }
                    if (response[i][9] == '1'){
                        var input_type = 'app'
                    }else{
                        var input_type = 'contact site'
                    }
                    var td10 = "<td>" +input_type + "</td>"
                    $("#customer-list_5").append(tr + td0 + td1 + td2 + td3 + td4 + td5 + td6 + td7 +td10 + td8 + td9);
                }
            }
        });

    }
    var log_payRef_ktb;
    function void_confirm($this){
        var payRef_ktb = $this.attr("data-tran-id");
        log_payRef_ktb = payRef_ktb
      
      
    }
    function void_Fastpay(){
        var payRef_ktb = log_payRef_ktb;
        var comment =   document.getElementById('void_comment').value
        $.ajax({
            url: '/click_void',
            type: 'POST',
            data:JSON.stringify(payRef_ktb+","+comment),
            contentType: "application/json",
            success: function (response) {
               if(response=='success'){
                 alert('ทำรายการคืนเงินลูกค้าเรียบร้อยแล้ว')
                 document.getElementById("voidEvent").disabled = true;
               }
               else{
                 alert('ไม่สามารถทำรายการคืนเงินลูกค้าได้ กรุณาติดต่อเจ้าหน้าที่')
               }
            }
        });

    }

    //รายการจองที่จอด
    function tableReserve_cus(){
        
        var getPark = document.getElementById("park").value
        var getLine = document.getElementById("line").value

        $.ajax({
            url: '/tableReserve_cus',
            type: 'POST',
            data: JSON.stringify(getLine + "," + getPark),
            contentType: "application/json",
            dataType: 'json',
            success: function (response) {
                $("#customer-list_6_show").html(""); 
                for (var i = 0; i < response.length; i++) {
                    var tr = "<tr>";
                    var td0 = "<td>" + response[i]['no'] + "</td>";
                    var td1 = "<td>" + response[i]['date'] + "</td>";
                    var td2 = "<td>" + response[i]['firstname'] + "</td>";
                    var td3 = "<td>" + response[i]['lastname'] + "</td>";
                    var td4 = "<td>" + response[i]['phone'] + "</td>";
                    var td5 = "<td>" + response[i]['station'] + "</td>";
                    var td6 = "<td>" + response[i]['total'] + "</td>";
                    var td7 = "<td>" + response[i]['payment_name'] + "</td>";
                    var td8 = "<td>" + response[i]['reserve_by'] + "</td>";
                    var td9 = "<td>" + response[i]['payment_status'] + "</td>";
                    var td10 = "<td>" + response[i]['payment_date'] + "</td>";
                    var td11 = "<td>" + response[i]['qr_code_exprie'] + "</td>";
                    if(response[i]['payment_status'] == 'ชำระแล้ว'){
                         var td12 = '<td class="textbox"><button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' + response[i]['id'] +'"onclick="testid_new($(this))"><i class="fas fa-print"></i> Print</button></td>'
                        //  var td13 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" onclick="reCeipt($(this))" data-target="#Modaledit_no-receipt2" data-tran-id="' + response[i]['id'] + '"> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit_inv2" data-tran-id="' + response[i]['id'] + '"onclick="addr_type2($(this))"> <i class="fas fa-edit"></i> แก้ไข(ที่อยู่ใบกำกับ)</button></td>'    
                    }
                    else{
                        var td12 = '<td class="textbox"><button class="btn btn-warning mr-2" data-toggle="modal" '+ 'data-tran-id="' + response[i]['id'] +'"onclick="testid_new($(this))" disabled><i class="fas fa-print" ></i> Print</button></td>' 
                        // var td13 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" onclick="reCeipt($(this))" data-target="#Modaledit_no-receipt2" data-tran-id="' + response[i]['id'] + '" disabled> <i class="fas fa-edit"></i> แก้ไข</button> <button class="btn btn-warning-del mr-2" data-toggle="modal" data-target="#Modaledit_inv2" data-tran-id="' + response[i]['id'] + '"onclick="addr_type2($(this))"disabled> <i class="fas fa-edit"></i> แก้ไข(ที่อยู่ใบกำกับ)</button></td>'   
                    }
                    var td13 = '<td class="textbox"><button class="btn btn-warning-del mr-2" data-toggle="modal" onclick="editAddressId($(this))" data-target="#Modaledit_no-receipt6" data-tran-id="' + response[i]['id'] + '"> <i class="fas fa-edit"></i> แก้ไข</button>'
                    $("#customer-list_6_show").append(tr+td0+td1+td2+td3+td4+td5+td6+td7+td8+td9+td10+td11+td12+td13);
                }
                // console.log(response[0]['date'])
            }
        })
    }
</script>

<script>
    // ตรวจสอบรหัสบัตรประชาชน
    $(document).ready(function () {
        $('#identity_card').on('keyup', function () {
            if ($.trim($(this).val()) != '' && $(this).val().length == 13) {
                id = $(this).val().replace(/-/g, "");
                var result = Script_checkID(id);
                if (result === false) {
                    $('span.error').removeClass('true').text('เลขบัตรประชาชนผิด');
                } else {
                    $('span.error').addClass('true').text('เลขบัตรประชาชนถูกต้อง');
                }
            } else {
                $('span.error').removeClass('true').text('');

            }
        })
    });
    // ตรวจสอบตัวแปรบัตรประชาชน
    function Script_checkID(id) {
        if (!IsNumeric(id)) return false;
        if (id.substring(0, 1) == 0) return false;
        if (id.length != 13) return false;
        for (i = 0, sum = 0; i < 12; i++)
            sum += parseFloat(id.charAt(i)) * (13 - i);
        if ((11 - sum % 11) % 10 != parseFloat(id.charAt(12))) return false;
        return true;
    }
    function IsNumeric(input) {
        var RE = /^-?(0|INF|(0[1-7][0-7]*)|(0x[0-9a-fA-F]+)|((0|[1-9][0-9]*|(?=[\.,]))([\.,][0-9]+)?([eE]-?\d+)?))$/;
        return (RE.test(input));
    }
</script>

<script>
    function validateSize(input) {
        const fileSize = input.files[0].size / 1024 / 1024;
        // console.log('asdfsdf')
        if (fileSize > 5) {
            alert('File size exceeds 2 MB');
            input.value = null
            // console.log('success')
        } else {

        }
    }
</script>

<script>
  var chatbox = document.getElementById('fb-customer-chat');
  chatbox.setAttribute("page_id", "106927381737911");
  chatbox.setAttribute("attribution", "biz_inbox");

  window.fbAsyncInit = function() {
    FB.init({
      xfbml            : true,
      version          : 'v11.0'
    });
  };

  (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0];
    if (d.getElementById(id)) return;
    js = d.createElement(s); js.id = id;
    js.src = 'https://connect.facebook.net/th_TH/sdk/xfbml.customerchat.js';
    fjs.parentNode.insertBefore(js, fjs);
  }(document, 'script', 'facebook-jssdk'));
</script>
<script>
    function editAddressId(btn){
        const id =  btn.attr("data-tran-id");
        document.getElementById('editAddressId').value = id
        console.log(id)
    }

    function changeAddress(){
        const id =  document.getElementById('editAddressId').value
        if (document.getElementById("address_home").checked === true){
            type = '1'
        }
        else{
            type = '2'
        }
        console.log(type)
        console.log(id)
        const data = {
            'address_type':type,
            'id':id
        }

        fetch('/change-address',{
            method: 'POST',
            headers: {'Content-Type': 'application/json'},
            body: JSON.stringify(data)
        })
    }
</script>

<script>
    //register//
    function apiRegister(){
            
        const stationCode = document.getElementById('parking_code').value
        const stationName = document.getElementById('station_name').value
        const memberCode = document.getElementById('identity_card').value
        const memberFirstname = document.getElementById('first_name_th').value            
        const memberLastname = document.getElementById('last_name_th').value
        const memberCardname= document.getElementById('card_id').value
        const approvedate= document.getElementById('service_start_date').value
            
        const requestOption = {
            method:"POST",
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({
                'stationCode':stationCode,
                'stationName':stationName,
                'memberCode' :memberCode,
                'memberFirstname' :memberFirstname,
                'memberLastname' :memberLastname,
                'memberCardname' :memberCardname,
                'approvedate' :approvedate,
            })
        }
        fetch('/v1/member/register',requestOption)
        .then(res=>res.json())
        .then(data=>console.log(data))
        }
    
</script>
<!-- <script>
    //renewal//
    function apiRenewal(){
        
        #        "username":"jparkapi",
        #        "password":"123456",
        #        "stationCode":parking_code,
        #        "memberCode":format_memberCode(identity_card),
        #        "memberCardName":card_id,
        #        "memberCardExpire":card_expire_date,
        #        "actionBy":"UJK001",
        #        "actionTimestamp":datetime.datetime.now()
        const stationCode = document.getElementById('parking_code').value
        const memberCode = document.getElementById('identity_card').value
        const memberCardname= document.getElementById('card_id').value
        const memberCardExpire= document.getElementById('card_expire_date').value

            
        const requestOption = {
            method:"POST",
            headers:{'Content-Type':'application/json'},
            body:JSON.stringify({
                'stationCode':stationCode,
                'stationName':stationName,
                'memberCode' :memberCode,
                'memberFirstname' :memberFirstname,
                'memberLastname' :memberLastname,
                'memberCardname' :memberCardname,
                'approvedate' :approvedate,
            })
        }
        fetch('/v1/member/register',requestOption)
        .then(res=>res.json())
        .then(data=>console.log(data))
        }
    
</script> -->
<script type="text/javascript">
    $("#new_client").submit(function(e) {
    e.preventDefault();    
    var formData = new FormData(this);

    $.ajax({
        url: window.location.pathname,
        type: 'POST',
        data: formData,
        success: function (data) {
            if (data.status){
                alert(data.message)
                window.location.reload()
            }else{
                alert(data.message)
            }
        },
        cache: false,
        contentType: false,
        processData: false
    });
});
</script>
</html>